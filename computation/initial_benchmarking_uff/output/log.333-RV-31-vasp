units           real
atom_style      full
boundary        p p p

pair_style      lj/cut 5.000
bond_style      harmonic
angle_style     hybrid cosine/periodic fourier
dihedral_style  harmonic

dielectric      1.0
pair_modify     tail yes mix arithmetic
special_bonds   lj/coul 0.0 0.0 1.0
box tilt        large

The 'box' command has been removed and will be ignored

read_data       ./dat/data.333-RV-31-vasp
Reading data file ...
  triclinic box = (0 0 0) to (15.411447 12.402704 17.503439) with tilt (-7.202679 -1.826073 0.338403)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  310 atoms
  scanning bonds ...
  4 = max bonds/atom
  scanning angles ...
  6 = max angles/atom
  scanning dihedrals ...
  30 = max dihedrals/atom
  triclinic box = (0 0 0) to (15.411447 12.402704 17.503439) with tilt (-7.202679 -1.826073 0.338403)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  1 by 1 by 1 MPI processor grid
  reading bonds ...
  315 bonds
  reading angles ...
  584 angles
  reading dihedrals ...
  669 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.006 seconds

#### Atom Groupings ####
group           1        id   21 33 86:87 152:160 182:184 233:235 243 281
21 atoms in group 1
group           fram     id   1:20 22:32 34:85 88:151 161:181 185:232 236:242 244:280 282:310
289 atoms in group fram
#### END Atom Groupings ####

compute am all property/atom mass
dump        atom_pos all extxyz 100 ./output/333-RV-31-vasp.lammpstrj
dump_modify atom_pos element Si H C O Si H C O mass yes
thermo          1000
thermo_style    custom step temp pe ke etotal press vol density

variable up equal 2e-2
variable cfac equal 1.0e-4
variable cunits string GPa

# Define minimization parameters
variable etol equal 0.0
variable ftol equal 1.0e-10
variable maxiter equal 100000
variable maxeval equal 100000
variable dmax equal 1.0e-2

variable temp equal 300.0
variable thermal_damp index 100.0
variable pressure_damp index 500.0

fix relax all box/relax aniso 0.0 vmax 0.001
unfix relax
minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 28 of 28 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 7 4 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
Per MPI rank memory allocation (min/avg/max) = 19.5 | 19.5 | 19.5 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Density    
         0   0              592.25807      0              592.25807      59104.108      3345.6706      1.4592149    
        62   0             -202.66987      0             -202.66987      13292.444      3345.6706      1.4592149    
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:1174)
Loop time of 0.030934 on 1 procs for 62 steps with 310 atoms

99.9% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
      592.258073438472  -202.669873616383  -202.669873616383
  Force two-norm initial, final = 712.02758 19.718734
  Force max component initial, final = 97.958374 4.6626369
  Final line search alpha, max atom move = 1.9481091e-11 9.0833256e-11
  Iterations, force evaluations = 62 175

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.020933   | 0.020933   | 0.020933   |   0.0 | 67.67
Bond    | 0.0047417  | 0.0047417  | 0.0047417  |   0.0 | 15.33
Neigh   | 0.0035456  | 0.0035456  | 0.0035456  |   0.0 | 11.46
Comm    | 0.00073449 | 0.00073449 | 0.00073449 |   0.0 |  2.37
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0009792  |            |       |  3.17

Nlocal:            310 ave         310 max         310 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2166 ave        2166 max        2166 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          19461 ave       19461 max       19461 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 19461
Ave neighs/atom = 62.777419
Ave special neighs/atom = 5.8
Neighbor list builds = 2
Dangerous builds = 0

# Generating the full routine as described in the paper for UFF
# fix nvt_relax   all nvt temp 300 300 ${thermal_damp}
# run 100000      # 100 picoseconds
# unfix           nvt_relax
#
# fix npt_relax   all npt temp 300 300 ${thermal_damp} iso 0 0 ${pressure_damp}
# run 100000      # 100 picoseconds
# unfix           npt_relax
#
# fix nvt_heat    all nvt temp 300 1000 ${thermal_damp}
# run 100000      # 100 picoseconds
# unfix           nvt_heat
#
# fix npt_heat    all npt temp 1000 1000 ${thermal_damp} iso 0 0 ${pressure_damp}
# run 100000      # 100 picoseconds
# unfix           npt_heat
#
# fix cooling_npt all npt temp 1000 300 ${thermal_damp} iso 0 0 ${pressure_damp}
# run 700000      # 700 picoseconds
# unfix           cooling_npt
#
# fix npt_final   all npt temp 300 300 ${thermal_damp} iso 0 0 100
# run 100000      # 100 picoseconds
# unfix           npt_final

# density computation
# variable rho equal density
# fix integrate  all npt temp ${temp} ${temp} ${thermal_damp} iso 0 0 ${pressure_damp}
# fix rho50k all ave/time 10 5000 50000 v_rho mode scalar ave one
# run 50000
# unfix integrate
# unfix rho50k

# Compute initial state
fix 3 all box/relax  aniso 0.0
minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 28 of 28 mixed pair_coeff terms from arithmetic mixing rule
WARNING: Energy due to 3 extra global DOFs will be included in minimizer energies
 (src/min.cpp:222)
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:1174)
Per MPI rank memory allocation (min/avg/max) = 20.56 | 20.56 | 20.56 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Density    
        62   0             -202.66987      0             -202.66987      13292.444      3345.6706      1.4592149    
        77   0             -202.9778       0             -202.9778       12636.835      3347.6606      1.4583474    
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:1174)
Loop time of 0.032305 on 1 procs for 15 steps with 310 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
     -202.669873616383  -202.977804994717  -202.977804994717
  Force two-norm initial, final = 1140.7183 1085.4948
  Force max component initial, final = 778.21616 742.53615
  Final line search alpha, max atom move = 8.0271708e-15 5.9604645e-12
  Iterations, force evaluations = 15 186

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.022139   | 0.022139   | 0.022139   |   0.0 | 68.53
Bond    | 0.0057652  | 0.0057652  | 0.0057652  |   0.0 | 17.85
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00070358 | 0.00070358 | 0.00070358 |   0.0 |  2.18
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.003698   |            |       | 11.45

Nlocal:            310 ave         310 max         310 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2166 ave        2166 max        2166 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          19457 ave       19457 max       19457 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 19457
Ave neighs/atom = 62.764516
Ave special neighs/atom = 5.8
Neighbor list builds = 0
Dangerous builds = 0

variable tmp equal pxx
variable pxx0 equal ${tmp}
variable pxx0 equal 9712.52733367233
variable tmp equal pyy
variable pyy0 equal ${tmp}
variable pyy0 equal 12985.3684852011
variable tmp equal pzz
variable pzz0 equal ${tmp}
variable pzz0 equal 15212.6083097728
variable tmp equal pyz
variable pyz0 equal ${tmp}
variable pyz0 equal -1707.76319486665
variable tmp equal pxz
variable pxz0 equal ${tmp}
variable pxz0 equal -2317.69935373325
variable tmp equal pxy
variable pxy0 equal ${tmp}
variable pxy0 equal -664.178062524159

variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.4138030569404
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 12.4052304694071
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.5076066686375

# These formulas define the derivatives w.r.t. strain components
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1-9712.52733367233)/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1-9712.52733367233)/(v_delta/v_len0)*0.0001
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1-12985.3684852011)/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1-12985.3684852011)/(v_delta/v_len0)*0.0001
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${cfac}
variable d3 equal -(v_pzz1-15212.6083097728)/(v_delta/v_len0)*${cfac}
variable d3 equal -(v_pzz1-15212.6083097728)/(v_delta/v_len0)*0.0001
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${cfac}
variable d4 equal -(v_pyz1--1707.76319486665)/(v_delta/v_len0)*${cfac}
variable d4 equal -(v_pyz1--1707.76319486665)/(v_delta/v_len0)*0.0001
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${cfac}
variable d5 equal -(v_pxz1--2317.69935373325)/(v_delta/v_len0)*${cfac}
variable d5 equal -(v_pxz1--2317.69935373325)/(v_delta/v_len0)*0.0001
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1--664.178062524159)/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1--664.178062524159)/(v_delta/v_len0)*0.0001

# displace_atoms all random ${atomjiggle} ${atomjiggle} ${atomjiggle} 87287 units box

# Write restart
unfix 3
write_restart restart_333-RV-31-vasp.equil
System init for write_restart ...
Generated 28 of 28 mixed pair_coeff terms from arithmetic mixing rule

# uxx Perturbation

variable dir equal 1
include ./input/displace_333-RV-31-vasp.mod
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 15.4138030569404
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart_333-RV-31-vasp.equil
Reading restart file ...
  restart file = 10 Sep 2025, LAMMPS = 10 Sep 2025
  restoring atom style full from restart
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.412625 12.403967 17.505523) with tilt (-7.2041462 -1.8265078 0.33848358)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  1 by 1 by 1 MPI processor grid
  restoring pair style lj/cut from restart
  restoring bond style harmonic from restart
  restoring angle style hybrid from restart
  restoring dihedral style harmonic from restart
  310 atoms
  315 bonds
  584 angles
  669 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.001 seconds
include ./input/angles_333-RV-31-vasp.mod
angle_style hybrid fourier cosine/periodic
angle_coeff 1 fourier 58.020602        0.343737        0.374972        0.281246
angle_coeff 2 fourier 83.380072        0.343737        0.374972        0.281246
angle_coeff 3 fourier 157.882480        0.343737        0.374972        0.281246
angle_coeff 4 fourier 221.735285        0.343737        0.374972        0.281246
angle_coeff 5 fourier 32.417871        0.343737        0.374972        0.281246
angle_coeff 6 fourier 114.246973        0.343737        0.374972        0.281246
angle_coeff 7 fourier 90.420412        0.343737        0.374972        0.281246
angle_coeff 8 fourier 75.498766        0.343737        0.374972        0.281246
angle_coeff 9 cosine/periodic 88.853997              -1               3

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.02*${len0}
variable delta equal -0.02*15.4138030569404
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.02*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.02*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.308276061138808 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.308276061138808 xy delta 0.1440829241626 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.308276061138808 xy delta 0.1440829241626 xz delta 0.036530155967886 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.104349 12.403967 17.505523) with tilt (-7.2041462 -1.8265078 0.33848358)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.104349 12.403967 17.505523) with tilt (-7.0600633 -1.8265078 0.33848358)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.104349 12.403967 17.505523) with tilt (-7.0600633 -1.7899776 0.33848358)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 28 of 28 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 7 4 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
Per MPI rank memory allocation (min/avg/max) = 19.5 | 19.5 | 19.5 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
        77   0             -402.83725      230.92138     -171.91588      34419.463    
        96   0             -406.42577      214.54341     -191.88236      17807.39     
Loop time of 0.0147786 on 1 procs for 19 steps with 310 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
     -171.915876293018   -191.88235806512   -191.88235806512
  Force two-norm initial, final = 140.95691 21.865765
  Force max component initial, final = 19.621697 3.3839267
  Final line search alpha, max atom move = 2.0003022e-11 6.7688761e-11
  Iterations, force evaluations = 19 93

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.011523   | 0.011523   | 0.011523   |   0.0 | 77.97
Bond    | 0.0025971  | 0.0025971  | 0.0025971  |   0.0 | 17.57
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00039548 | 0.00039548 | 0.00039548 |   0.0 |  2.68
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.000263   |            |       |  1.78

Nlocal:            310 ave         310 max         310 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2192 ave        2192 max        2192 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          19817 ave       19817 max       19817 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 19817
Ave neighs/atom = 63.925806
Ave special neighs/atom = 5.8
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 16227.669867239
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 18248.670688195
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 18945.828857653
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -290.914827093601
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -1580.18646362718
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -1923.17848026313

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 32.5757126678334
variable C2neg equal ${d2}
variable C2neg equal 26.3165110149695
variable C3neg equal ${d3}
variable C3neg equal 18.666102739401
variable C4neg equal ${d4}
variable C4neg equal -1.0770764269824
variable C5neg equal ${d5}
variable C5neg equal 3.68756445053035
variable C6neg equal ${d6}
variable C6neg equal 1.86631617715279

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart_333-RV-31-vasp.equil
Reading restart file ...
  restart file = 10 Sep 2025, LAMMPS = 10 Sep 2025
  restoring atom style full from restart
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.412625 12.403967 17.505523) with tilt (-7.2041462 -1.8265078 0.33848358)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  1 by 1 by 1 MPI processor grid
  restoring pair style lj/cut from restart
  restoring bond style harmonic from restart
  restoring angle style hybrid from restart
  restoring dihedral style harmonic from restart
  310 atoms
  315 bonds
  584 angles
  669 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.001 seconds
include ./input/angles_333-RV-31-vasp.mod
angle_style hybrid fourier cosine/periodic
angle_coeff 1 fourier 58.020602        0.343737        0.374972        0.281246
angle_coeff 2 fourier 83.380072        0.343737        0.374972        0.281246
angle_coeff 3 fourier 157.882480        0.343737        0.374972        0.281246
angle_coeff 4 fourier 221.735285        0.343737        0.374972        0.281246
angle_coeff 5 fourier 32.417871        0.343737        0.374972        0.281246
angle_coeff 6 fourier 114.246973        0.343737        0.374972        0.281246
angle_coeff 7 fourier 90.420412        0.343737        0.374972        0.281246
angle_coeff 8 fourier 75.498766        0.343737        0.374972        0.281246
angle_coeff 9 cosine/periodic 88.853997              -1               3

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.02*${len0}
variable delta equal 0.02*15.4138030569404
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.02*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.02*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.308276061138808 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.308276061138808 xy delta -0.1440829241626 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.308276061138808 xy delta -0.1440829241626 xz delta -0.036530155967886 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.720901 12.403967 17.505523) with tilt (-7.2041462 -1.8265078 0.33848358)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.720901 12.403967 17.505523) with tilt (-7.3482291 -1.8265078 0.33848358)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.720901 12.403967 17.505523) with tilt (-7.3482291 -1.863038 0.33848358)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 28 of 28 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 8 4 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:1174)
Per MPI rank memory allocation (min/avg/max) = 19.5 | 19.5 | 19.5 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
        77   0             -421.70347      230.24793     -191.45555     -8362.0463    
       109   0             -418.59747      203.32683     -215.27064      9484.5005    
Loop time of 0.0171197 on 1 procs for 32 steps with 310 atoms

99.1% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
     -191.455546794463  -215.270638318843  -215.270638318843
  Force two-norm initial, final = 142.84363 20.110483
  Force max component initial, final = 18.164993 2.9319325
  Final line search alpha, max atom move = 2.5540918e-11 7.4884249e-11
  Iterations, force evaluations = 32 117

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.013211   | 0.013211   | 0.013211   |   0.0 | 77.17
Bond    | 0.0031257  | 0.0031257  | 0.0031257  |   0.0 | 18.26
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00043519 | 0.00043519 | 0.00043519 |   0.0 |  2.54
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0003473  |            |       |  2.03

Nlocal:            310 ave         310 max         310 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2138 ave        2138 max        2138 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          19036 ave       19036 max       19036 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 19036
Ave neighs/atom = 61.406452
Ave special neighs/atom = 5.8
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -215.270638318843
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 9484.50051828165
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 5590.6201567553
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 9684.90557708565
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 13177.975821004
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 440.706665502604
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -2017.7661340985
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -1985.54596534516

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 20.6095358845851
variable C2pos equal ${d2}
variable C2pos equal 16.5023145405772
variable C3pos equal ${d3}
variable C3pos equal 10.173162443844
variable C4pos equal ${d4}
variable C4pos equal 1.38891385239255
variable C5pos equal ${d5}
variable C5pos equal -1.49966609817375
variable C6pos equal ${d6}
variable C6pos equal -5.52442364013382

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(32.5757126678334+${C1pos})
variable C11 equal 0.5*(32.5757126678334+20.6095358845851)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(26.3165110149695+${C2pos})
variable C21 equal 0.5*(26.3165110149695+16.5023145405772)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(18.666102739401+${C3pos})
variable C31 equal 0.5*(18.666102739401+10.173162443844)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-1.0770764269824+${C4pos})
variable C41 equal 0.5*(-1.0770764269824+1.38891385239255)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(3.68756445053035+${C5pos})
variable C51 equal 0.5*(3.68756445053035+-1.49966609817375)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(1.86631617715279+${C6pos})
variable C61 equal 0.5*(1.86631617715279+-5.52442364013382)

# Delete dir to make sure it is not reused

variable dir delete

# uyy Perturbation

variable dir equal 2
include ./input/displace_333-RV-31-vasp.mod
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 12.4052304694071
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart_333-RV-31-vasp.equil
Reading restart file ...
  restart file = 10 Sep 2025, LAMMPS = 10 Sep 2025
  restoring atom style full from restart
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.412625 12.403967 17.505523) with tilt (-7.2041462 -1.8265078 0.33848358)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  1 by 1 by 1 MPI processor grid
  restoring pair style lj/cut from restart
  restoring bond style harmonic from restart
  restoring angle style hybrid from restart
  restoring dihedral style harmonic from restart
  310 atoms
  315 bonds
  584 angles
  669 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.001 seconds
include ./input/angles_333-RV-31-vasp.mod
angle_style hybrid fourier cosine/periodic
angle_coeff 1 fourier 58.020602        0.343737        0.374972        0.281246
angle_coeff 2 fourier 83.380072        0.343737        0.374972        0.281246
angle_coeff 3 fourier 157.882480        0.343737        0.374972        0.281246
angle_coeff 4 fourier 221.735285        0.343737        0.374972        0.281246
angle_coeff 5 fourier 32.417871        0.343737        0.374972        0.281246
angle_coeff 6 fourier 114.246973        0.343737        0.374972        0.281246
angle_coeff 7 fourier 90.420412        0.343737        0.374972        0.281246
angle_coeff 8 fourier 75.498766        0.343737        0.374972        0.281246
angle_coeff 9 cosine/periodic 88.853997              -1               3

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.02*${len0}
variable delta equal -0.02*12.4052304694071
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.02*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.02*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.248104609388142 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.248104609388142 yz delta -0.00676967151368019 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.412625 12.155863 17.505523) with tilt (-7.2041462 -1.8265078 0.33848358)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.412625 12.155863 17.505523) with tilt (-7.2041462 -1.8265078 0.3317139)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 28 of 28 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 7 4 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:1174)
Per MPI rank memory allocation (min/avg/max) = 19.5 | 19.5 | 19.5 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
        77   0             -401.30462      234.60841     -166.69621      35355.075    
        96   0             -402.92775      216.23683     -186.69092      19051.047    
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:1174)
Loop time of 0.0145894 on 1 procs for 19 steps with 310 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
     -166.696212216418  -186.690918984307  -186.690918984307
  Force two-norm initial, final = 151.11591 19.222747
  Force max component initial, final = 20.478183 2.4750478
  Final line search alpha, max atom move = 3.2116856e-11 7.9490755e-11
  Iterations, force evaluations = 19 93

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.011343   | 0.011343   | 0.011343   |   0.0 | 77.75
Bond    | 0.0025365  | 0.0025365  | 0.0025365  |   0.0 | 17.39
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00040427 | 0.00040427 | 0.00040427 |   0.0 |  2.77
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0003055  |            |       |  2.09

Nlocal:            310 ave         310 max         310 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2182 ave        2182 max        2182 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          19876 ave       19876 max       19876 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 19876
Ave neighs/atom = 64.116129
Ave special neighs/atom = 5.8
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 14304.6286371106
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 22876.7122234736
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 19971.7990838576
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -591.287372656604
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -2281.96535280442
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -1410.14816940273

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 22.9605065171914
variable C2neg equal ${d2}
variable C2neg equal 49.4567186913625
variable C3neg equal ${d3}
variable C3neg equal 23.795953870424
variable C4neg equal ${d4}
variable C4neg equal 1.4880751273196
variable C5neg equal ${d5}
variable C5neg equal 0.17867000464415
variable C6neg equal ${d6}
variable C6neg equal 0.364453449337775

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart_333-RV-31-vasp.equil
Reading restart file ...
  restart file = 10 Sep 2025, LAMMPS = 10 Sep 2025
  restoring atom style full from restart
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.412625 12.403967 17.505523) with tilt (-7.2041462 -1.8265078 0.33848358)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  1 by 1 by 1 MPI processor grid
  restoring pair style lj/cut from restart
  restoring bond style harmonic from restart
  restoring angle style hybrid from restart
  restoring dihedral style harmonic from restart
  310 atoms
  315 bonds
  584 angles
  669 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.001 seconds
include ./input/angles_333-RV-31-vasp.mod
angle_style hybrid fourier cosine/periodic
angle_coeff 1 fourier 58.020602        0.343737        0.374972        0.281246
angle_coeff 2 fourier 83.380072        0.343737        0.374972        0.281246
angle_coeff 3 fourier 157.882480        0.343737        0.374972        0.281246
angle_coeff 4 fourier 221.735285        0.343737        0.374972        0.281246
angle_coeff 5 fourier 32.417871        0.343737        0.374972        0.281246
angle_coeff 6 fourier 114.246973        0.343737        0.374972        0.281246
angle_coeff 7 fourier 90.420412        0.343737        0.374972        0.281246
angle_coeff 8 fourier 75.498766        0.343737        0.374972        0.281246
angle_coeff 9 cosine/periodic 88.853997              -1               3

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.02*${len0}
variable delta equal 0.02*12.4052304694071
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.02*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.02*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.248104609388142 yz delta ${deltayz} remap units box
change_box all y delta 0 0.248104609388142 yz delta 0.00676967151368019 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.412625 12.652072 17.505523) with tilt (-7.2041462 -1.8265078 0.33848358)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.412625 12.652072 17.505523) with tilt (-7.2041462 -1.8265078 0.34525325)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 28 of 28 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 7 4 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
Per MPI rank memory allocation (min/avg/max) = 19.5 | 19.5 | 19.5 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
        77   0             -421.90897      229.22557     -192.6834      -9246.7353    
       116   0             -421.05976      201.34322     -219.71653      8288.8784    
Loop time of 0.0217412 on 1 procs for 39 steps with 310 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
     -192.683400033952  -219.716534380495  -219.716534380495
  Force two-norm initial, final = 154.66055 16.591384
  Force max component initial, final = 20.030782 2.4622366
  Final line search alpha, max atom move = 3.9994946e-11 9.8477021e-11
  Iterations, force evaluations = 39 131

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.01538    | 0.01538    | 0.01538    |   0.0 | 70.74
Bond    | 0.0035882  | 0.0035882  | 0.0035882  |   0.0 | 16.50
Neigh   | 0.0017857  | 0.0017857  | 0.0017857  |   0.0 |  8.21
Comm    | 0.00056783 | 0.00056783 | 0.00056783 |   0.0 |  2.61
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.000419   |            |       |  1.93

Nlocal:            310 ave         310 max         310 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2128 ave        2128 max        2128 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          19085 ave       19085 max       19085 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 19085
Ave neighs/atom = 61.564516
Ave special neighs/atom = 5.8
Neighbor list builds = 1
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -219.716534380495
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 8288.87838191916
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 4826.26674473626
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 8609.80888271511
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 11430.5595183061
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 552.745581638273
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -1240.77449720988
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -2414.78799086165

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 24.4313029446803
variable C2pos equal ${d2}
variable C2pos equal 21.8777980124299
variable C3pos equal ${d3}
variable C3pos equal 18.9102439573335
variable C4pos equal ${d4}
variable C4pos equal 3.535123979975
variable C5pos equal ${d5}
variable C5pos equal -5.38462428261685
variable C6pos equal ${d6}
variable C6pos equal -6.08461822081216

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(22.9605065171914+${C1pos})
variable C12 equal 0.5*(22.9605065171914+24.4313029446803)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(49.4567186913625+${C2pos})
variable C22 equal 0.5*(49.4567186913625+21.8777980124299)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(23.795953870424+${C3pos})
variable C32 equal 0.5*(23.795953870424+18.9102439573335)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(1.4880751273196+${C4pos})
variable C42 equal 0.5*(1.4880751273196+3.535123979975)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(0.17867000464415+${C5pos})
variable C52 equal 0.5*(0.17867000464415+-5.38462428261685)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(0.364453449337775+${C6pos})
variable C62 equal 0.5*(0.364453449337775+-6.08461822081216)

# Delete dir to make sure it is not reused

variable dir delete

# uzz Perturbation

variable dir equal 3
include ./input/displace_333-RV-31-vasp.mod
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.5076066686375
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart_333-RV-31-vasp.equil
Reading restart file ...
  restart file = 10 Sep 2025, LAMMPS = 10 Sep 2025
  restoring atom style full from restart
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.412625 12.403967 17.505523) with tilt (-7.2041462 -1.8265078 0.33848358)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  1 by 1 by 1 MPI processor grid
  restoring pair style lj/cut from restart
  restoring bond style harmonic from restart
  restoring angle style hybrid from restart
  restoring dihedral style harmonic from restart
  310 atoms
  315 bonds
  584 angles
  669 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.001 seconds
include ./input/angles_333-RV-31-vasp.mod
angle_style hybrid fourier cosine/periodic
angle_coeff 1 fourier 58.020602        0.343737        0.374972        0.281246
angle_coeff 2 fourier 83.380072        0.343737        0.374972        0.281246
angle_coeff 3 fourier 157.882480        0.343737        0.374972        0.281246
angle_coeff 4 fourier 221.735285        0.343737        0.374972        0.281246
angle_coeff 5 fourier 32.417871        0.343737        0.374972        0.281246
angle_coeff 6 fourier 114.246973        0.343737        0.374972        0.281246
angle_coeff 7 fourier 90.420412        0.343737        0.374972        0.281246
angle_coeff 8 fourier 75.498766        0.343737        0.374972        0.281246
angle_coeff 9 cosine/periodic 88.853997              -1               3

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.02*${len0}
variable delta equal -0.02*17.5076066686375
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.02*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.02*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.35015213337275 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.412625 12.403967 17.155371) with tilt (-7.2041462 -1.8265078 0.33848358)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 28 of 28 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 7 4 5
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
Per MPI rank memory allocation (min/avg/max) = 19.5 | 19.5 | 19.5 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
        77   0             -402.39629      237.87037     -164.52592      35521.036    
       116   0             -404.66241      216.78724     -187.87517      17864.746    
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:1174)
Loop time of 0.0211709 on 1 procs for 39 steps with 310 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
     -164.525919267558  -187.875166245697  -187.875166245697
  Force two-norm initial, final = 147.44322 14.338245
  Force max component initial, final = 21.683005 3.2407796
  Final line search alpha, max atom move = 4.7722412e-11 1.5465782e-10
  Iterations, force evaluations = 39 131

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.016479   | 0.016479   | 0.016479   |   0.0 | 77.84
Bond    | 0.0036741  | 0.0036741  | 0.0036741  |   0.0 | 17.35
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00058413 | 0.00058413 | 0.00058413 |   0.0 |  2.76
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0004336  |            |       |  2.05

Nlocal:            310 ave         310 max         310 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2178 ave        2178 max        2178 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          19842 ave       19842 max       19842 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 19842
Ave neighs/atom = 64.006452
Ave special neighs/atom = 5.8
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 11853.1502077492
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 18184.7880201997
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 23556.2990869003
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -264.869353088606
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -1813.30756323091
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -2462.22515623317

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 10.7031143703844
variable C2neg equal ${d2}
variable C2neg equal 25.997097674993
variable C3neg equal ${d3}
variable C3neg equal 41.7184538856375
variable C4neg equal ${d4}
variable C4neg equal -3.7723098068326
variable C5neg equal ${d5}
variable C5neg equal 2.5219589525117
variable C6neg equal ${d6}
variable C6neg equal 1.99654354717777

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart_333-RV-31-vasp.equil
Reading restart file ...
  restart file = 10 Sep 2025, LAMMPS = 10 Sep 2025
  restoring atom style full from restart
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.412625 12.403967 17.505523) with tilt (-7.2041462 -1.8265078 0.33848358)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  1 by 1 by 1 MPI processor grid
  restoring pair style lj/cut from restart
  restoring bond style harmonic from restart
  restoring angle style hybrid from restart
  restoring dihedral style harmonic from restart
  310 atoms
  315 bonds
  584 angles
  669 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.001 seconds
include ./input/angles_333-RV-31-vasp.mod
angle_style hybrid fourier cosine/periodic
angle_coeff 1 fourier 58.020602        0.343737        0.374972        0.281246
angle_coeff 2 fourier 83.380072        0.343737        0.374972        0.281246
angle_coeff 3 fourier 157.882480        0.343737        0.374972        0.281246
angle_coeff 4 fourier 221.735285        0.343737        0.374972        0.281246
angle_coeff 5 fourier 32.417871        0.343737        0.374972        0.281246
angle_coeff 6 fourier 114.246973        0.343737        0.374972        0.281246
angle_coeff 7 fourier 90.420412        0.343737        0.374972        0.281246
angle_coeff 8 fourier 75.498766        0.343737        0.374972        0.281246
angle_coeff 9 cosine/periodic 88.853997              -1               3

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.02*${len0}
variable delta equal 0.02*17.5076066686375
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.02*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.02*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.35015213337275 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.412625 12.403967 17.855675) with tilt (-7.2041462 -1.8265078 0.33848358)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 28 of 28 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 7 4 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:1174)
Per MPI rank memory allocation (min/avg/max) = 19.48 | 19.48 | 19.48 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
        77   0             -421.95194      225.83429     -196.11765     -9457.5355    
        98   0             -423.54469      206.55451     -216.99018      8367.5352    
Loop time of 0.0146286 on 1 procs for 21 steps with 310 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
      -196.11764768249  -216.990181543598  -216.990181543598
  Force two-norm initial, final = 152.60834 17.19235
  Force max component initial, final = 19.851834 3.2774501
  Final line search alpha, max atom move = 2.6628695e-11 8.7274218e-11
  Iterations, force evaluations = 21 97

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.011326   | 0.011326   | 0.011326   |   0.0 | 77.42
Bond    | 0.0026339  | 0.0026339  | 0.0026339  |   0.0 | 18.00
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00040979 | 0.00040979 | 0.00040979 |   0.0 |  2.80
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0002593  |            |       |  1.77

Nlocal:            310 ave         310 max         310 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2150 ave        2150 max        2150 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          19073 ave       19073 max       19073 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 19073
Ave neighs/atom = 61.525806
Ave special neighs/atom = 5.8
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -216.990181543598
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 8367.53522087113
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 6752.76888203816
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 10215.964902753
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 8133.87187782226
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -586.548548890864
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -1756.53112258819
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -2069.17699829247

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 14.7987922581709
variable C2pos equal ${d2}
variable C2pos equal 13.8470179122405
variable C3pos equal ${d3}
variable C3pos equal 35.3936821597527
variable C4pos equal ${d4}
variable C4pos equal 1.8070690171291
variable C5pos equal ${d5}
variable C5pos equal -2.8058411557253
variable C6pos equal ${d6}
variable C6pos equal -0.388147568166475

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(10.7031143703844+${C1pos})
variable C13 equal 0.5*(10.7031143703844+14.7987922581709)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(25.997097674993+${C2pos})
variable C23 equal 0.5*(25.997097674993+13.8470179122405)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(41.7184538856375+${C3pos})
variable C33 equal 0.5*(41.7184538856375+35.3936821597527)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-3.7723098068326+${C4pos})
variable C43 equal 0.5*(-3.7723098068326+1.8070690171291)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(2.5219589525117+${C5pos})
variable C53 equal 0.5*(2.5219589525117+-2.8058411557253)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(1.99654354717777+${C6pos})
variable C63 equal 0.5*(1.99654354717777+-0.388147568166475)

# Delete dir to make sure it is not reused

variable dir delete

# uyz Perturbation

variable dir equal 4
include ./input/displace_333-RV-31-vasp.mod
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.5076066686375
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart_333-RV-31-vasp.equil
Reading restart file ...
  restart file = 10 Sep 2025, LAMMPS = 10 Sep 2025
  restoring atom style full from restart
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.412625 12.403967 17.505523) with tilt (-7.2041462 -1.8265078 0.33848358)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  1 by 1 by 1 MPI processor grid
  restoring pair style lj/cut from restart
  restoring bond style harmonic from restart
  restoring angle style hybrid from restart
  restoring dihedral style harmonic from restart
  310 atoms
  315 bonds
  584 angles
  669 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.001 seconds
include ./input/angles_333-RV-31-vasp.mod
angle_style hybrid fourier cosine/periodic
angle_coeff 1 fourier 58.020602        0.343737        0.374972        0.281246
angle_coeff 2 fourier 83.380072        0.343737        0.374972        0.281246
angle_coeff 3 fourier 157.882480        0.343737        0.374972        0.281246
angle_coeff 4 fourier 221.735285        0.343737        0.374972        0.281246
angle_coeff 5 fourier 32.417871        0.343737        0.374972        0.281246
angle_coeff 6 fourier 114.246973        0.343737        0.374972        0.281246
angle_coeff 7 fourier 90.420412        0.343737        0.374972        0.281246
angle_coeff 8 fourier 75.498766        0.343737        0.374972        0.281246
angle_coeff 9 cosine/periodic 88.853997              -1               3

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.02*${len0}
variable delta equal -0.02*17.5076066686375
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.02*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.02*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.35015213337275 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.412625 12.403967 17.505523) with tilt (-7.2041462 -1.8265078 -0.011668558)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 28 of 28 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 7 4 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:1174)
Per MPI rank memory allocation (min/avg/max) = 19.5 | 19.5 | 19.5 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
        77   0             -414.98358      219.89357     -195.09001      12119.753    
        98   0             -414.59826      208.59703     -206.00123      13081.011    
Loop time of 0.014711 on 1 procs for 21 steps with 310 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
     -195.090011380973  -206.001225406257  -206.001225406257
  Force two-norm initial, final = 111.97491 17.166181
  Force max component initial, final = 14.979914 2.518076
  Final line search alpha, max atom move = 4.1399184e-11 1.0424629e-10
  Iterations, force evaluations = 21 95

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.011419   | 0.011419   | 0.011419   |   0.0 | 77.62
Bond    | 0.0026185  | 0.0026185  | 0.0026185  |   0.0 | 17.80
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00037798 | 0.00037798 | 0.00037798 |   0.0 |  2.57
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0002952  |            |       |  2.01

Nlocal:            310 ave         310 max         310 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2166 ave        2166 max        2166 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          19427 ave       19427 max       19427 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 19427
Ave neighs/atom = 62.667742
Ave special neighs/atom = 5.8
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 9494.38372010119
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 13954.5131481138
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 15794.1357603468
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -673.988286092075
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -1925.621518281
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 86.0381906349426

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal -1.0907180678557
variable C2neg equal ${d2}
variable C2neg equal 4.8457233145635
variable C3neg equal ${d3}
variable C3neg equal 2.90763725287
variable C4neg equal ${d4}
variable C4neg equal 8.96900692750796
variable C5neg equal ${d5}
variable C5neg equal 1.96038917726125
variable C6neg equal ${d6}
variable C6neg equal -0.0490511178395798

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart_333-RV-31-vasp.equil
Reading restart file ...
  restart file = 10 Sep 2025, LAMMPS = 10 Sep 2025
  restoring atom style full from restart
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.412625 12.403967 17.505523) with tilt (-7.2041462 -1.8265078 0.33848358)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  1 by 1 by 1 MPI processor grid
  restoring pair style lj/cut from restart
  restoring bond style harmonic from restart
  restoring angle style hybrid from restart
  restoring dihedral style harmonic from restart
  310 atoms
  315 bonds
  584 angles
  669 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.001 seconds
include ./input/angles_333-RV-31-vasp.mod
angle_style hybrid fourier cosine/periodic
angle_coeff 1 fourier 58.020602        0.343737        0.374972        0.281246
angle_coeff 2 fourier 83.380072        0.343737        0.374972        0.281246
angle_coeff 3 fourier 157.882480        0.343737        0.374972        0.281246
angle_coeff 4 fourier 221.735285        0.343737        0.374972        0.281246
angle_coeff 5 fourier 32.417871        0.343737        0.374972        0.281246
angle_coeff 6 fourier 114.246973        0.343737        0.374972        0.281246
angle_coeff 7 fourier 90.420412        0.343737        0.374972        0.281246
angle_coeff 8 fourier 75.498766        0.343737        0.374972        0.281246
angle_coeff 9 cosine/periodic 88.853997              -1               3

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.02*${len0}
variable delta equal 0.02*17.5076066686375
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.02*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.02*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.35015213337275 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.412625 12.403967 17.505523) with tilt (-7.2041462 -1.8265078 0.68863571)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 28 of 28 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 7 4 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:1174)
Per MPI rank memory allocation (min/avg/max) = 19.5 | 19.5 | 19.5 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
        77   0             -411.95866      220.95521     -191.00346      12867.968    
        88   0             -413.50501      213.72907     -199.77594      12987.56     
Loop time of 0.0124596 on 1 procs for 11 steps with 310 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
     -191.003456527112  -199.775936547092  -199.775936547092
  Force two-norm initial, final = 110.78135 20.163343
  Force max component initial, final = 14.717168 4.1613285
  Final line search alpha, max atom move = 2.2472092e-11 9.3513758e-11
  Iterations, force evaluations = 11 79

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.0096852  | 0.0096852  | 0.0096852  |   0.0 | 77.73
Bond    | 0.0022338  | 0.0022338  | 0.0022338  |   0.0 | 17.93
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00032846 | 0.00032846 | 0.00032846 |   0.0 |  2.64
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0002121  |            |       |  1.70

Nlocal:            310 ave         310 max         310 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2162 ave        2162 max        2162 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          19443 ave       19443 max       19443 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 19443
Ave neighs/atom = 62.719355
Ave special neighs/atom = 5.8
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -199.775936547092
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 12987.5599472328
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 9687.34701540539
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 13315.1960125273
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 15960.1368137657
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -544.423710122597
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -2449.4412366231
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -5496.19894359637

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 0.125901591334696
variable C2pos equal ${d2}
variable C2pos equal -1.649137636631
variable C3pos equal ${d3}
variable C3pos equal -3.73764251996449
variable C4pos equal ${d4}
variable C4pos equal 18.9421787436486
variable C5pos equal ${d5}
variable C5pos equal 0.658709414449249
variable C6pos equal ${d6}
variable C6pos equal -0.598771762007811

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-1.0907180678557+${C1pos})
variable C14 equal 0.5*(-1.0907180678557+0.125901591334696)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(4.8457233145635+${C2pos})
variable C24 equal 0.5*(4.8457233145635+-1.649137636631)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(2.90763725287+${C3pos})
variable C34 equal 0.5*(2.90763725287+-3.73764251996449)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(8.96900692750796+${C4pos})
variable C44 equal 0.5*(8.96900692750796+18.9421787436486)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(1.96038917726125+${C5pos})
variable C54 equal 0.5*(1.96038917726125+0.658709414449249)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-0.0490511178395798+${C6pos})
variable C64 equal 0.5*(-0.0490511178395798+-0.598771762007811)

# Delete dir to make sure it is not reused

variable dir delete

# uxz Perturbation

variable dir equal 5
include ./input/displace_333-RV-31-vasp.mod
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.5076066686375
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart_333-RV-31-vasp.equil
Reading restart file ...
  restart file = 10 Sep 2025, LAMMPS = 10 Sep 2025
  restoring atom style full from restart
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.412625 12.403967 17.505523) with tilt (-7.2041462 -1.8265078 0.33848358)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  1 by 1 by 1 MPI processor grid
  restoring pair style lj/cut from restart
  restoring bond style harmonic from restart
  restoring angle style hybrid from restart
  restoring dihedral style harmonic from restart
  310 atoms
  315 bonds
  584 angles
  669 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.001 seconds
include ./input/angles_333-RV-31-vasp.mod
angle_style hybrid fourier cosine/periodic
angle_coeff 1 fourier 58.020602        0.343737        0.374972        0.281246
angle_coeff 2 fourier 83.380072        0.343737        0.374972        0.281246
angle_coeff 3 fourier 157.882480        0.343737        0.374972        0.281246
angle_coeff 4 fourier 221.735285        0.343737        0.374972        0.281246
angle_coeff 5 fourier 32.417871        0.343737        0.374972        0.281246
angle_coeff 6 fourier 114.246973        0.343737        0.374972        0.281246
angle_coeff 7 fourier 90.420412        0.343737        0.374972        0.281246
angle_coeff 8 fourier 75.498766        0.343737        0.374972        0.281246
angle_coeff 9 cosine/periodic 88.853997              -1               3

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.02*${len0}
variable delta equal -0.02*17.5076066686375
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.02*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.02*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.35015213337275 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.412625 12.403967 17.505523) with tilt (-7.2041462 -2.1766599 0.33848358)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 28 of 28 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 8 4 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:1174)
Per MPI rank memory allocation (min/avg/max) = 19.5 | 19.5 | 19.5 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
        77   0             -414.32273      218.4363      -195.88643      11806.835    
        93   0             -415.71174      209.99494     -205.7168       12958.092    
Loop time of 0.0122385 on 1 procs for 16 steps with 310 atoms

107.3% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
     -195.886425430439  -205.716804095541  -205.716804095541
  Force two-norm initial, final = 112.43765 16.144126
  Force max component initial, final = 14.375924 2.7387936
  Final line search alpha, max atom move = 3.465432e-11 9.491103e-11
  Iterations, force evaluations = 16 87

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.0094298  | 0.0094298  | 0.0094298  |   0.0 | 77.05
Bond    | 0.002226   | 0.002226   | 0.002226   |   0.0 | 18.19
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00032805 | 0.00032805 | 0.00032805 |   0.0 |  2.68
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0002546  |            |       |  2.08

Nlocal:            310 ave         310 max         310 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2166 ave        2166 max        2166 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          19437 ave       19437 max       19437 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 19437
Ave neighs/atom = 62.7
Ave special neighs/atom = 5.8
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 9952.42003401912
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 13373.6944976392
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 15548.1608221963
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -516.038425929694
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 267.074642820488
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -1960.68769665788

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 1.19946350173395
variable C2neg equal ${d2}
variable C2neg equal 1.94163006219051
variable C3neg equal ${d3}
variable C3neg equal 1.6777625621175
variable C4neg equal ${d4}
variable C4neg equal -1.26462250895615
variable C5neg equal ${d5}
variable C5neg equal 12.9238699827687
variable C6neg equal ${d6}
variable C6neg equal 0.740698182972325

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart_333-RV-31-vasp.equil
Reading restart file ...
  restart file = 10 Sep 2025, LAMMPS = 10 Sep 2025
  restoring atom style full from restart
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.412625 12.403967 17.505523) with tilt (-7.2041462 -1.8265078 0.33848358)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  1 by 1 by 1 MPI processor grid
  restoring pair style lj/cut from restart
  restoring bond style harmonic from restart
  restoring angle style hybrid from restart
  restoring dihedral style harmonic from restart
  310 atoms
  315 bonds
  584 angles
  669 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.001 seconds
include ./input/angles_333-RV-31-vasp.mod
angle_style hybrid fourier cosine/periodic
angle_coeff 1 fourier 58.020602        0.343737        0.374972        0.281246
angle_coeff 2 fourier 83.380072        0.343737        0.374972        0.281246
angle_coeff 3 fourier 157.882480        0.343737        0.374972        0.281246
angle_coeff 4 fourier 221.735285        0.343737        0.374972        0.281246
angle_coeff 5 fourier 32.417871        0.343737        0.374972        0.281246
angle_coeff 6 fourier 114.246973        0.343737        0.374972        0.281246
angle_coeff 7 fourier 90.420412        0.343737        0.374972        0.281246
angle_coeff 8 fourier 75.498766        0.343737        0.374972        0.281246
angle_coeff 9 cosine/periodic 88.853997              -1               3

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.02*${len0}
variable delta equal 0.02*17.5076066686375
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.02*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.02*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.35015213337275 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.412625 12.403967 17.505523) with tilt (-7.2041462 -1.4763557 0.33848358)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 28 of 28 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 7 4 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:1174)
Per MPI rank memory allocation (min/avg/max) = 19.5 | 19.5 | 19.5 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
        77   0             -413.363        222.33934     -191.02366      13144.167    
        87   0             -413.62937      214.03906     -199.59032      13286.025    
Loop time of 0.0111789 on 1 procs for 10 steps with 310 atoms

109.1% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
      -191.02365985855  -199.590316449074  -199.590316449074
  Force two-norm initial, final = 111.98786 19.260796
  Force max component initial, final = 14.337079 2.8858584
  Final line search alpha, max atom move = 2.5040261e-11 7.2262648e-11
  Iterations, force evaluations = 10 77

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.0086952  | 0.0086952  | 0.0086952  |   0.0 | 77.78
Bond    | 0.0019985  | 0.0019985  | 0.0019985  |   0.0 | 17.88
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00029511 | 0.00029511 | 0.00029511 |   0.0 |  2.64
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0001901  |            |       |  1.70

Nlocal:            310 ave         310 max         310 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2162 ave        2162 max        2162 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          19420 ave       19420 max       19420 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 19420
Ave neighs/atom = 62.645161
Ave special neighs/atom = 5.8
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -199.590316449074
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 13286.0249801152
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 9683.95008447329
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 13897.7400555108
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 16276.3848003616
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -564.656304787405
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -5837.60784801733
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -1753.02827403949

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 0.142886245995196
variable C2pos equal ${d2}
variable C2pos equal -4.5618578515485
variable C3pos equal ${d3}
variable C3pos equal -5.318882452944
variable C4pos equal ${d4}
variable C4pos equal 0.2263253958642
variable C5pos equal ${d5}
variable C5pos equal 17.5995424714204
variable C6pos equal ${d6}
variable C6pos equal -0.49760878868377

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(1.19946350173395+${C1pos})
variable C15 equal 0.5*(1.19946350173395+0.142886245995196)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(1.94163006219051+${C2pos})
variable C25 equal 0.5*(1.94163006219051+-4.5618578515485)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(1.6777625621175+${C3pos})
variable C35 equal 0.5*(1.6777625621175+-5.318882452944)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-1.26462250895615+${C4pos})
variable C45 equal 0.5*(-1.26462250895615+0.2263253958642)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(12.9238699827687+${C5pos})
variable C55 equal 0.5*(12.9238699827687+17.5995424714204)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(0.740698182972325+${C6pos})
variable C65 equal 0.5*(0.740698182972325+-0.49760878868377)

# Delete dir to make sure it is not reused

variable dir delete

# uxy Perturbation

variable dir equal 6
include ./input/displace_333-RV-31-vasp.mod
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 12.4052304694071

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart_333-RV-31-vasp.equil
Reading restart file ...
  restart file = 10 Sep 2025, LAMMPS = 10 Sep 2025
  restoring atom style full from restart
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.412625 12.403967 17.505523) with tilt (-7.2041462 -1.8265078 0.33848358)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  1 by 1 by 1 MPI processor grid
  restoring pair style lj/cut from restart
  restoring bond style harmonic from restart
  restoring angle style hybrid from restart
  restoring dihedral style harmonic from restart
  310 atoms
  315 bonds
  584 angles
  669 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.001 seconds
include ./input/angles_333-RV-31-vasp.mod
angle_style hybrid fourier cosine/periodic
angle_coeff 1 fourier 58.020602        0.343737        0.374972        0.281246
angle_coeff 2 fourier 83.380072        0.343737        0.374972        0.281246
angle_coeff 3 fourier 157.882480        0.343737        0.374972        0.281246
angle_coeff 4 fourier 221.735285        0.343737        0.374972        0.281246
angle_coeff 5 fourier 32.417871        0.343737        0.374972        0.281246
angle_coeff 6 fourier 114.246973        0.343737        0.374972        0.281246
angle_coeff 7 fourier 90.420412        0.343737        0.374972        0.281246
angle_coeff 8 fourier 75.498766        0.343737        0.374972        0.281246
angle_coeff 9 cosine/periodic 88.853997              -1               3

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.02*${len0}
variable delta equal -0.02*12.4052304694071
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.02*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.02*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.248104609388142 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.412625 12.403967 17.505523) with tilt (-7.4522508 -1.8265078 0.33848358)

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 28 of 28 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 8 4 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:1174)
Per MPI rank memory allocation (min/avg/max) = 19.5 | 19.5 | 19.5 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
        77   0             -413.46651      219.38539     -194.08112      11875.37     
        85   0             -414.08074      212.27881     -201.80193      12805.975    
Loop time of 0.0114938 on 1 procs for 8 steps with 310 atoms

108.7% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
     -194.081119721013  -201.801932816889  -201.801932816889
  Force two-norm initial, final = 115.35687 18.512331
  Force max component initial, final = 15.637564 4.5325588
  Final line search alpha, max atom move = 3.561949e-11 1.6144743e-10
  Iterations, force evaluations = 8 72

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.0088369  | 0.0088369  | 0.0088369  |   0.0 | 76.88
Bond    | 0.0020931  | 0.0020931  | 0.0020931  |   0.0 | 18.21
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00031915 | 0.00031915 | 0.00031915 |   0.0 |  2.78
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0002447  |            |       |  2.13

Nlocal:            310 ave         310 max         310 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2174 ave        2174 max        2174 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          19467 ave       19467 max       19467 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 19467
Ave neighs/atom = 62.796774
Ave special neighs/atom = 5.8
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 9931.13832959051
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 12847.9063024142
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 15638.8817549505
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 3429.85777669004
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -2693.27098307825
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -1986.77568798806

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 1.09305497959091
variable C2neg equal ${d2}
variable C2neg equal -0.687310913934498
variable C3neg equal ${d3}
variable C3neg equal 2.1313672258885
variable C4neg equal ${d4}
variable C4neg equal -1.39506246560705
variable C5neg equal ${d5}
variable C5neg equal -1.877858146725
variable C6neg equal ${d6}
variable C6neg equal 20.470179196071

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart_333-RV-31-vasp.equil
Reading restart file ...
  restart file = 10 Sep 2025, LAMMPS = 10 Sep 2025
  restoring atom style full from restart
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.412625 12.403967 17.505523) with tilt (-7.2041462 -1.8265078 0.33848358)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  1 by 1 by 1 MPI processor grid
  restoring pair style lj/cut from restart
  restoring bond style harmonic from restart
  restoring angle style hybrid from restart
  restoring dihedral style harmonic from restart
  310 atoms
  315 bonds
  584 angles
  669 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.001 seconds
include ./input/angles_333-RV-31-vasp.mod
angle_style hybrid fourier cosine/periodic
angle_coeff 1 fourier 58.020602        0.343737        0.374972        0.281246
angle_coeff 2 fourier 83.380072        0.343737        0.374972        0.281246
angle_coeff 3 fourier 157.882480        0.343737        0.374972        0.281246
angle_coeff 4 fourier 221.735285        0.343737        0.374972        0.281246
angle_coeff 5 fourier 32.417871        0.343737        0.374972        0.281246
angle_coeff 6 fourier 114.246973        0.343737        0.374972        0.281246
angle_coeff 7 fourier 90.420412        0.343737        0.374972        0.281246
angle_coeff 8 fourier 75.498766        0.343737        0.374972        0.281246
angle_coeff 9 cosine/periodic 88.853997              -1               3

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.02*${len0}
variable delta equal 0.02*12.4052304694071
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.02*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.02*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.248104609388142 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:221)
  triclinic box = (-0.0011780285 -0.0012632347 -0.0020838343) to (15.412625 12.403967 17.505523) with tilt (-6.9560416 -1.8265078 0.33848358)

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 28 of 28 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 7 4 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:1174)
Per MPI rank memory allocation (min/avg/max) = 19.5 | 19.5 | 19.5 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
        77   0             -413.55263      220.32456     -193.22807      13114.627    
       115   0             -416.35063      206.04244     -210.30819      12715.065    
WARNING: Bond/angle/dihedral extent > half of periodic box length (src/domain.cpp:1174)
Loop time of 0.0224118 on 1 procs for 38 steps with 310 atoms

106.9% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
     -193.228072829857  -210.308187484263  -210.308187484263
  Force two-norm initial, final = 116.51281 17.75402
  Force max component initial, final = 15.217666 3.6620686
  Final line search alpha, max atom move = 2.0172022e-11 7.3871328e-11
  Iterations, force evaluations = 38 131

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.015968   | 0.015968   | 0.015968   |   0.0 | 71.25
Bond    | 0.00361    | 0.00361    | 0.00361    |   0.0 | 16.11
Neigh   | 0.0017995  | 0.0017995  | 0.0017995  |   0.0 |  8.03
Comm    | 0.00058088 | 0.00058088 | 0.00058088 |   0.0 |  2.59
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0004536  |            |       |  2.02

Nlocal:            310 ave         310 max         310 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2146 ave        2146 max        2146 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          19488 ave       19488 max       19488 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 19488
Ave neighs/atom = 62.864516
Ave special neighs/atom = 5.8
Neighbor list builds = 1
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -210.308187484263
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 12715.0653773145
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 9149.94703525241
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 14396.9623997878
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 14598.2866969032
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -1032.87852969597
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -683.683529925566
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -1293.62718004036

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 2.8129014920996
variable C2pos equal ${d2}
variable C2pos equal -7.05796957293351
variable C3pos equal ${d3}
variable C3pos equal 3.071608064348
variable C4pos equal ${d4}
variable C4pos equal -2.07068007413145
variable C5pos equal ${d5}
variable C5pos equal -8.17007911903842
variable C6pos equal ${d6}
variable C6pos equal 1.84350233585905

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(1.09305497959091+${C1pos})
variable C16 equal 0.5*(1.09305497959091+2.8129014920996)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-0.687310913934498+${C2pos})
variable C26 equal 0.5*(-0.687310913934498+-7.05796957293351)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(2.1313672258885+${C3pos})
variable C36 equal 0.5*(2.1313672258885+3.071608064348)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-1.39506246560705+${C4pos})
variable C46 equal 0.5*(-1.39506246560705+-2.07068007413145)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(-1.877858146725+${C5pos})
variable C56 equal 0.5*(-1.877858146725+-8.17007911903842)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(20.470179196071+${C6pos})
variable C66 equal 0.5*(20.470179196071+1.84350233585905)

# Delete dir to make sure it is not reused

variable dir delete

# Output final values

variable C11all equal ${C11}
variable C11all equal 26.5926242762092
variable C22all equal ${C22}
variable C22all equal 35.6672583518962
variable C33all equal ${C33}
variable C33all equal 38.5560680226951

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(23.6959047309359+${C21})
variable C12all equal 0.5*(23.6959047309359+21.4094127777733)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(12.7509533142777+${C31})
variable C13all equal 0.5*(12.7509533142777+14.4196325916225)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(19.9220577936168+${C32})
variable C23all equal 0.5*(19.9220577936168+21.3530989138787)

variable C44all equal ${C44}
variable C44all equal 13.9555928355783
variable C55all equal ${C55}
variable C55all equal 15.2617062270945
variable C66all equal ${C66}
variable C66all equal 11.156840765965

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-0.482408238260502+${C41})
variable C14all equal 0.5*(-0.482408238260502+0.155918712705075)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(0.671174873864573+${C51})
variable C15all equal 0.5*(0.671174873864573+1.0939491761783)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(1.95297823584525+${C61})
variable C16all equal 0.5*(1.95297823584525+-1.82905373149052)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(1.59829283896625+${C42})
variable C24all equal 0.5*(1.59829283896625+2.5115995536473)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-1.31011389467899+${C52})
variable C25all equal 0.5*(-1.31011389467899+-2.60297713898635)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(-3.872640243434+${C62})
variable C26all equal 0.5*(-3.872640243434+-2.86008238573719)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(-0.415002633547245+${C43})
variable C34all equal 0.5*(-0.415002633547245+-0.98262039485175)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-1.82055994541325+${C53})
variable C35all equal 0.5*(-1.82055994541325+-0.1419411016068)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(2.60148764511825+${C63})
variable C36all equal 0.5*(2.60148764511825+0.804197989505647)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-0.519148556545975+${C54})
variable C45all equal 0.5*(-0.519148556545975+1.30954929585525)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-1.73287126986925+${C64})
variable C46all equal 0.5*(-1.73287126986925+-0.323911439923695)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(-5.02396863288171+${C65})
variable C56all equal 0.5*(-5.02396863288171+0.121544697144278)

# Average moduli for cubic crystals

variable C11cubic equal (${C11all}+${C22all}+${C33all})/3.0
variable C11cubic equal (26.5926242762092+${C22all}+${C33all})/3.0
variable C11cubic equal (26.5926242762092+35.6672583518962+${C33all})/3.0
variable C11cubic equal (26.5926242762092+35.6672583518962+38.5560680226951)/3.0
variable C12cubic equal (${C12all}+${C13all}+${C23all})/3.0
variable C12cubic equal (22.5526587543546+${C13all}+${C23all})/3.0
variable C12cubic equal (22.5526587543546+13.5852929529501+${C23all})/3.0
variable C12cubic equal (22.5526587543546+13.5852929529501+20.6375783537477)/3.0
variable C44cubic equal (${C44all}+${C55all}+${C66all})/3.0
variable C44cubic equal (13.9555928355783+${C55all}+${C66all})/3.0
variable C44cubic equal (13.9555928355783+15.2617062270945+${C66all})/3.0
variable C44cubic equal (13.9555928355783+15.2617062270945+11.156840765965)/3.0

variable bulkmodulus equal (${C11cubic}+2*${C12cubic})/3.0
variable bulkmodulus equal (33.6053168836002+2*${C12cubic})/3.0
variable bulkmodulus equal (33.6053168836002+2*18.9251766870175)/3.0
variable shearmodulus1 equal ${C44cubic}
variable shearmodulus1 equal 13.4580466095459
variable shearmodulus2 equal (${C11cubic}-${C12cubic})/2.0
variable shearmodulus2 equal (33.6053168836002-${C12cubic})/2.0
variable shearmodulus2 equal (33.6053168836002-18.9251766870175)/2.0
variable poissonratio equal 1.0/(1.0+${C11cubic}/${C12cubic})
variable poissonratio equal 1.0/(1.0+33.6053168836002/${C12cubic})
variable poissonratio equal 1.0/(1.0+33.6053168836002/18.9251766870175)

print "Elastic Constant 1 1 = ${C11all}"
Elastic Constant 1 1 = 26.5926242762092
print "Elastic Constant 2 2 = ${C22all}"
Elastic Constant 2 2 = 35.6672583518962
print "Elastic Constant 3 3 = ${C33all}"
Elastic Constant 3 3 = 38.5560680226951

print "Elastic Constant 1 2 = ${C12all}"
Elastic Constant 1 2 = 22.5526587543546
print "Elastic Constant 1 3 = ${C13all}"
Elastic Constant 1 3 = 13.5852929529501
print "Elastic Constant 2 3 = ${C23all}"
Elastic Constant 2 3 = 20.6375783537477

print "Elastic Constant 4 4 = ${C44all}"
Elastic Constant 4 4 = 13.9555928355783
print "Elastic Constant 5 5 = ${C55all}"
Elastic Constant 5 5 = 15.2617062270945
print "Elastic Constant 6 6 = ${C66all}"
Elastic Constant 6 6 = 11.156840765965

print "Elastic Constant 1 4 = ${C14all}"
Elastic Constant 1 4 = -0.163244762777713
print "Elastic Constant 1 5 = ${C15all}"
Elastic Constant 1 5 = 0.882562025021437
print "Elastic Constant 1 6 = ${C16all}"
Elastic Constant 1 6 = 0.0619622521773651

print "Elastic Constant 2 4 = ${C24all}"
Elastic Constant 2 4 = 2.05494619630677
print "Elastic Constant 2 5 = ${C25all}"
Elastic Constant 2 5 = -1.95654551683267
print "Elastic Constant 2 6 = ${C26all}"
Elastic Constant 2 6 = -3.3663613145856

print "Elastic Constant 3 4 = ${C34all}"
Elastic Constant 3 4 = -0.698811514199497
print "Elastic Constant 3 5 = ${C35all}"
Elastic Constant 3 5 = -0.981250523510025
print "Elastic Constant 3 6 = ${C36all}"
Elastic Constant 3 6 = 1.70284281731195

print "Elastic Constant 4 5 = ${C45all}"
Elastic Constant 4 5 = 0.395200369654637
print "Elastic Constant 4 6 = ${C46all}"
Elastic Constant 4 6 = -1.02839135489647
print "Elastic Constant 5 6 = ${C56all}"
Elastic Constant 5 6 = -2.45121196786872

print "Bulk Modulus = ${bulkmodulus} ${cunits}"
Bulk Modulus = 23.8185567525451 GPa
print "Shear Modulus 1 = ${shearmodulus1} ${cunits}"
Shear Modulus 1 = 13.4580466095459 GPa
print "Shear Modulus 2 = ${shearmodulus2} ${cunits}"
Shear Modulus 2 = 7.34007009829135 GPa
print "Poisson Ratio = ${poissonratio}"
Poisson Ratio = 0.360270300174813

variable rho equal density
print "density (g/cm^3) = ${rho}"
density (g/cm^3) = 1.4583474235062
Total wall time: 0:00:00
