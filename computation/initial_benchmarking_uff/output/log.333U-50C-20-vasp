units           real
atom_style      full
boundary        p p p

pair_style      lj/cut 5.000
bond_style      harmonic
angle_style     hybrid fourier cosine/periodic
dihedral_style  harmonic

dielectric      1.0
special_bonds   lj/coul 0.0 0.0 1.0
pair_modify     tail yes mix arithmetic
box tilt        large

The 'box' command has been removed and will be ignored

read_data       ./dat/data.333U-50C-20-vasp
Reading data file ...
  triclinic box = (0 0 0) to (15.238206 14.502811 17.008496) with tilt (-6.262741 -0.448186 -0.641994)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  350 atoms
  scanning bonds ...
  4 = max bonds/atom
  scanning angles ...
  6 = max angles/atom
  scanning dihedrals ...
  30 = max dihedrals/atom
  triclinic box = (0 0 0) to (15.238206 14.502811 17.008496) with tilt (-6.262741 -0.448186 -0.641994)
  1 by 1 by 1 MPI processor grid
  reading bonds ...
  375 bonds
  reading angles ...
  709 angles
  reading dihedrals ...
  879 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.009 seconds

#### Atom Groupings ####
group           fram     id   1:350
350 atoms in group fram
#### END Atom Groupings ####

compute am all property/atom mass
dump        atom_pos all extxyz 100 ./output/333U-50C-20-vasp.lammpstrj
dump_modify atom_pos element Si C H O mass yes
thermo          1000
thermo_style    custom step temp pe ke etotal press vol density

variable up equal 2e-2
variable cfac equal 1.0e-4
variable cunits string GPa

# Define minimization parameters
variable etol equal 0.0
variable ftol equal 1.0e-10
variable maxiter equal 100000
variable maxeval equal 100000
variable dmax equal 1.0e-2

variable temp equal 300.0
variable thermal_damp index 100.0
variable pressure_damp index 500.0

fix relax all box/relax aniso 0.0 vmax 0.001
unfix relax
minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 6 of 6 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 7 5 5
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
Per MPI rank memory allocation (min/avg/max) = 19.51 | 19.51 | 19.51 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Density    
         0   0              1272.689       0              1272.689       98781.481      3758.8236      1.7278645    
        66   0             -16.639303      0             -16.639303      15733.727      3758.8236      1.7278645    
Loop time of 0.0383007 on 1 procs for 66 steps with 350 atoms

97.3% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
      1272.68903998096  -16.6393031610201  -16.6393031610201
  Force two-norm initial, final = 901.271 27.323435
  Force max component initial, final = 114.73042 5.4623319
  Final line search alpha, max atom move = 1.4764214e-11 8.0647034e-11
  Iterations, force evaluations = 66 189

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.02619    | 0.02619    | 0.02619    |   0.0 | 68.38
Bond    | 0.006323   | 0.006323   | 0.006323   |   0.0 | 16.51
Neigh   | 0.003839   | 0.003839   | 0.003839   |   0.0 | 10.02
Comm    | 0.0008694  | 0.0008694  | 0.0008694  |   0.0 |  2.27
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.001079   |            |       |  2.82

Nlocal:            350 ave         350 max         350 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2194 ave        2194 max        2194 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          22163 ave       22163 max       22163 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 22163
Ave neighs/atom = 63.322857
Ave special neighs/atom = 6.1942857
Neighbor list builds = 2
Dangerous builds = 0

# Generating the full routine as described in the paper for UFF
fix nvt_relax   all nvt temp 300 300 ${thermal_damp}
fix nvt_relax   all nvt temp 300 300 100.0
run 100000      # 100 picoseconds
Generated 6 of 6 mixed pair_coeff terms from arithmetic mixing rule
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
Per MPI rank memory allocation (min/avg/max) = 19.45 | 19.45 | 19.45 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Density    
        66   0             -16.639303      0             -16.639303      15733.727      3758.8236      1.7278645    
      1000   277.23944      220.95872      288.41294      509.37167      20240.122      3758.8236      1.7278645    
      2000   307.51341      256.39951      319.90703      576.30654      19205.777      3758.8236      1.7278645    
      3000   289.66112      267.54709      301.33525      568.88234      23609.343      3758.8236      1.7278645    
      4000   303.10969      212.36529      315.32583      527.69111      16655.005      3758.8236      1.7278645    
      5000   308.57535      262.10712      321.01178      583.11889      20750.839      3758.8236      1.7278645    
      6000   282.41544      241.2964       293.79755      535.09394      17405.654      3758.8236      1.7278645    
      7000   331.19641      246.51001      344.54453      591.05454      21097.434      3758.8236      1.7278645    
      8000   298.53983      236.00914      310.57179      546.58092      21118.917      3758.8236      1.7278645    
      9000   317.64029      271.5175       330.44205      601.95955      21010.216      3758.8236      1.7278645    
     10000   299.69996      242.15672      311.77868      553.9354       20950.907      3758.8236      1.7278645    
     11000   314.4165       252.41826      327.08833      579.50659      17347.767      3758.8236      1.7278645    
     12000   303.98682      238.47568      316.23831      554.71399      14177.286      3758.8236      1.7278645    
     13000   299.08401      237.62247      311.13791      548.76038      15976.725      3758.8236      1.7278645    
     14000   303.22327      258.78871      315.44399      574.2327       26644.725      3758.8236      1.7278645    
     15000   309.05107      244.78062      321.50666      566.28729      14928.752      3758.8236      1.7278645    
     16000   285.58319      228.58399      297.09297      525.67696      21387.921      3758.8236      1.7278645    
     17000   289.02225      255.81924      300.67063      556.48987      14565.359      3758.8236      1.7278645    
     18000   283.3545       251.01955      294.77445      545.79401      17491.305      3758.8236      1.7278645    
     19000   320.14962      258.14038      333.05251      591.19289      18732.445      3758.8236      1.7278645    
     20000   302.93239      237.00906      315.14139      552.15044      18285.877      3758.8236      1.7278645    
     21000   287.64492      253.93972      299.23779      553.17751      18885.679      3758.8236      1.7278645    
     22000   297.65983      253.35473      309.65633      563.01106      22415.456      3758.8236      1.7278645    
     23000   313.48352      222.55546      326.11776      548.67322      16779.905      3758.8236      1.7278645    
     24000   302.10989      232.74763      314.28574      547.03337      19338.138      3758.8236      1.7278645    
     25000   302.86387      224.89134      315.07011      539.96145      23275.913      3758.8236      1.7278645    
     26000   288.35156      223.90654      299.97291      523.87945      17598.078      3758.8236      1.7278645    
     27000   324.64678      245.94444      337.73093      583.67537      16732.477      3758.8236      1.7278645    
     28000   310.52424      208.06322      323.03921      531.10242      16532.966      3758.8236      1.7278645    
     29000   290.68527      260.11942      302.40067      562.5201       16120.513      3758.8236      1.7278645    
     30000   292.8422       200.97063      304.64454      505.61517      15442.454      3758.8236      1.7278645    
     31000   305.05815      238.88737      317.35282      556.24018      15295.305      3758.8236      1.7278645    
     32000   300.44668      208.89959      312.5555       521.45509      19556.635      3758.8236      1.7278645    
     33000   294.60786      214.90027      306.48136      521.38163      16859.497      3758.8236      1.7278645    
     34000   311.54377      218.59075      324.09983      542.69059      23640.852      3758.8236      1.7278645    
     35000   287.67502      219.39154      299.2691       518.66064      18093.214      3758.8236      1.7278645    
     36000   304.24744      242.78929      316.50943      559.29872      13937.685      3758.8236      1.7278645    
     37000   283.65792      236.79721      295.0901       531.8873       22187.561      3758.8236      1.7278645    
     38000   290.52843      245.02626      302.23752      547.26378      21521.195      3758.8236      1.7278645    
     39000   300.4562       232.47076      312.5654       545.03616      17918.391      3758.8236      1.7278645    
     40000   288.62977      222.97712      300.26233      523.23946      16281.463      3758.8236      1.7278645    
     41000   302.68076      236.76156      314.87961      551.64117      16686.902      3758.8236      1.7278645    
     42000   287.8945       249.79752      299.49742      549.29494      20449.383      3758.8236      1.7278645    
     43000   284.5997       232.00321      296.06984      528.07305      18695.749      3758.8236      1.7278645    
     44000   309.51381      237.79168      321.98806      559.77973      19772.162      3758.8236      1.7278645    
     45000   305.13191      238.56612      317.42955      555.99567      22683.54       3758.8236      1.7278645    
     46000   309.239        223.70251      321.70217      545.40468      18236.667      3758.8236      1.7278645    
     47000   284.60403      229.42842      296.07435      525.50276      21730.681      3758.8236      1.7278645    
     48000   307.61884      235.45586      320.01671      555.47257      22683.724      3758.8236      1.7278645    
     49000   302.122        220.70976      314.29834      535.00809      20991.608      3758.8236      1.7278645    
     50000   305.09923      241.02357      317.39556      558.41913      18078.178      3758.8236      1.7278645    
     51000   306.84253      230.49532      319.20911      549.70443      16967.887      3758.8236      1.7278645    
     52000   298.70239      204.64472      310.74091      515.38563      17195.908      3758.8236      1.7278645    
     53000   314.10601      224.35214      326.76533      551.11748      15931.227      3758.8236      1.7278645    
     54000   287.56187      242.44615      299.1514       541.59755      19429.734      3758.8236      1.7278645    
     55000   296.09681      226.3218       308.03032      534.35212      20863.21       3758.8236      1.7278645    
     56000   289.54016      237.93562      301.20941      539.14503      18761.869      3758.8236      1.7278645    
     57000   285.55882      218.05791      297.06762      515.12553      18572.093      3758.8236      1.7278645    
     58000   292.93125      243.17126      304.73718      547.90843      14593.506      3758.8236      1.7278645    
     59000   298.51394      206.39109      310.54486      516.93595      20017.275      3758.8236      1.7278645    
     60000   301.01304      227.40666      313.14468      540.55134      17220.327      3758.8236      1.7278645    
     61000   276.09052      227.60883      287.21771      514.82654      25817.703      3758.8236      1.7278645    
     62000   312.77076      217.59977      325.37626      542.97603      20785.632      3758.8236      1.7278645    
     63000   326.59784      209.48627      339.76061      549.24688      17226.902      3758.8236      1.7278645    
     64000   277.23814      231.75369      288.41159      520.16528      20163.453      3758.8236      1.7278645    
     65000   332.83961      225.98668      346.25395      572.24063      17479.527      3758.8236      1.7278645    
     66000   279.78011      234.24812      291.05601      525.30413      22819.154      3758.8236      1.7278645    
     67000   309.54779      250.86022      322.02341      572.88363      21341.862      3758.8236      1.7278645    
     68000   294.1371       218.1787       305.99162      524.17032      20722.778      3758.8236      1.7278645    
     69000   323.63431      210.98273      336.67765      547.66039      25328.252      3758.8236      1.7278645    
     70000   285.66816      232.41198      297.18136      529.59334      24921.945      3758.8236      1.7278645    
     71000   312.08931      226.24485      324.66736      550.9122       18507.184      3758.8236      1.7278645    
     72000   287.93219      214.3521       299.53663      513.88873      23248.871      3758.8236      1.7278645    
     73000   290.90526      235.71621      302.62953      538.34574      18221.575      3758.8236      1.7278645    
     74000   305.07604      219.94319      317.37143      537.31461      20442.623      3758.8236      1.7278645    
     75000   282.51022      205.29464      293.89614      499.19078      19001.907      3758.8236      1.7278645    
     76000   307.57152      226.22223      319.96749      546.18972      16849.901      3758.8236      1.7278645    
     77000   293.08696      230.70161      304.89915      535.60077      23806.153      3758.8236      1.7278645    
     78000   278.8149       229.20125      290.0519       519.25315      22077.069      3758.8236      1.7278645    
     79000   302.66998      251.89796      314.8684       566.76636      22145.604      3758.8236      1.7278645    
     80000   283.92407      224.83467      295.36698      520.20165      19301.668      3758.8236      1.7278645    
     81000   317.74035      225.57183      330.54615      556.11798      15479.176      3758.8236      1.7278645    
     82000   299.30455      246.45787      311.36733      557.8252       24876.061      3758.8236      1.7278645    
     83000   301.17942      219.61784      313.31777      532.93561      21736.833      3758.8236      1.7278645    
     84000   285.83482      232.82787      297.35474      530.1826       17340.053      3758.8236      1.7278645    
     85000   300.50325      255.39721      312.61434      568.01155      15824.701      3758.8236      1.7278645    
     86000   296.64716      236.91201      308.60284      545.51485      14512.396      3758.8236      1.7278645    
     87000   301.48692      215.60166      313.63766      529.23932      23265.216      3758.8236      1.7278645    
     88000   308.90104      231.04517      321.35059      552.39577      16264.156      3758.8236      1.7278645    
     89000   306.1931       200.95157      318.53351      519.48508      20128.204      3758.8236      1.7278645    
     90000   307.66811      249.26627      320.06796      569.33423      17579.839      3758.8236      1.7278645    
     91000   299.76805      227.47518      311.84952      539.32469      18450.453      3758.8236      1.7278645    
     92000   307.26671      216.0976       319.65039      535.74798      17502.544      3758.8236      1.7278645    
     93000   326.92376      221.01775      340.09967      561.11743      17732.2        3758.8236      1.7278645    
     94000   320.19091      211.65925      333.09547      544.75473      18696.257      3758.8236      1.7278645    
     95000   298.03735      234.10577      310.04906      544.15483      16550.644      3758.8236      1.7278645    
     96000   298.317        224.25505      310.33998      534.59503      19353.036      3758.8236      1.7278645    
     97000   293.05828      236.84386      304.86932      541.71318      18360.625      3758.8236      1.7278645    
     98000   318.89353      218.43448      331.7458       550.18029      23815.184      3758.8236      1.7278645    
     99000   297.86579      243.998        309.87058      553.86858      17519.397      3758.8236      1.7278645    
    100000   281.78796      239.51867      293.14478      532.66346      17032.883      3758.8236      1.7278645    
    100066   280.74287      223.1962       292.05757      515.25377      23437.465      3758.8236      1.7278645    
Loop time of 21.2936 on 1 procs for 100000 steps with 350 atoms

Performance: 405.756 ns/day, 0.059 hours/ns, 4696.255 timesteps/s, 1.644 Matom-step/s
99.7% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 12.732     | 12.732     | 12.732     |   0.0 | 59.79
Bond    | 3.2869     | 3.2869     | 3.2869     |   0.0 | 15.44
Neigh   | 3.8583     | 3.8583     | 3.8583     |   0.0 | 18.12
Comm    | 0.50378    | 0.50378    | 0.50378    |   0.0 |  2.37
Output  | 0.48107    | 0.48107    | 0.48107    |   0.0 |  2.26
Modify  | 0.31703    | 0.31703    | 0.31703    |   0.0 |  1.49
Other   |            | 0.1145     |            |       |  0.54

Nlocal:            350 ave         350 max         350 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2176 ave        2176 max        2176 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          22111 ave       22111 max       22111 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 22111
Ave neighs/atom = 63.174286
Ave special neighs/atom = 6.1942857
Neighbor list builds = 1816
Dangerous builds = 0
unfix           nvt_relax

fix npt_relax   all npt temp 300 300 ${thermal_damp} iso 0 0 ${pressure_damp}
fix npt_relax   all npt temp 300 300 100.0 iso 0 0 ${pressure_damp}
fix npt_relax   all npt temp 300 300 100.0 iso 0 0 500.0
run 100000      # 100 picoseconds
Generated 6 of 6 mixed pair_coeff terms from arithmetic mixing rule
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
Per MPI rank memory allocation (min/avg/max) = 19.47 | 19.47 | 19.47 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Density    
    100066   280.74287      223.1962       292.05757      515.25377      23437.465      3758.8236      1.7278645    
    101000   311.78532      234.78187      324.35112      559.13299      7685.8728      3958.4023      1.6407473    
    102000   290.46726      224.51226      302.17387      526.68614     -3293.8252      4004.8724      1.6217091    
    103000   328.09711      226.75521      341.32031      568.07553      572.75433      3956.6698      1.6414657    
    104000   280.83213      224.70865      292.15043      516.85908     -282.05646      3928.9655      1.6530402    
    105000   303.59187      247.80819      315.82744      563.63563     -2480.9588      3956.1178      1.6416948    
    106000   277.81742      253.63034      289.01421      542.64455      813.13596      3944.7486      1.6464263    
    107000   300.58138      216.54587      312.69562      529.24149      917.91758      3952.6836      1.6431211    
    108000   301.16703      225.12484      313.30487      538.42971     -4349.6444      3953.9816      1.6425817    
    109000   309.81423      226.83687      322.30059      549.13746      4077.2254      3960.9391      1.6396965    
    110000   304.898        235.54109      317.18621      552.7273       3208.4697      3917.8121      1.6577462    
    111000   296.23077      213.8872       308.16967      522.05687     -300.71987      3939.6405      1.648561     
    112000   314.64987      241.49761      327.33111      568.82873      2984.4484      3938.1334      1.649192     
    113000   312.37894      227.83621      324.96866      552.80486     -3941.064       3963.0177      1.6388365    
    114000   305.06885      200.13334      317.36395      517.49729     -3340.0196      3972.9365      1.634745     
    115000   302.35293      227.18459      314.53857      541.72316     -6347.864       3987.1339      1.628924     
    116000   307.59022      194.63866      319.98694      514.6256       3979.5219      3928.577       1.6532037    
    117000   306.89578      214.61572      319.26451      533.88024      5515.2906      3948.4913      1.6448657    
    118000   282.89096      241.15724      294.29223      535.44947      748.55707      3957.3619      1.6411787    
    119000   284.95299      226.71292      296.43737      523.15029     -2403.7035      3916.2584      1.6584038    
    120000   300.05065      220.77292      312.1435       532.91642     -3585.2767      3988.6612      1.6283002    
    121000   263.16974      200.57217      273.77619      474.34836      2756.5939      3930.0028      1.6526039    
    122000   304.69354      221.32305      316.97352      538.29657      10442.165      3917.2568      1.6579811    
    123000   286.32776      197.40254      297.86754      495.27008     -1571.4447      3935.8811      1.6501357    
    124000   294.22809      227.04906      306.08628      533.13534     -2278.903       3973.8618      1.6343643    
    125000   280.3206       220.72098      291.61828      512.33926     -6878.5328      3968.235       1.6366818    
    126000   305.14884      213.92426      317.44717      531.37143     -2999.1973      3945.6428      1.6460532    
    127000   300.54658      213.66694      312.65942      526.32636     -4543.5399      3919.9805      1.6568292    
    128000   295.97075      230.11447      307.89918      538.01364     -1425.6231      3963.7094      1.6385505    
    129000   313.31734      228.66863      325.94487      554.6135       411.91564      3954.6033      1.6423235    
    130000   298.55098      214.56248      310.58339      525.14587     -2925.7263      3953.1597      1.6429232    
    131000   314.57163      214.90876      327.24972      542.15847      3566.1938      3948.5601      1.644837     
    132000   285.13103      211.52028      296.62258      508.14287     -2144.2656      3964.1935      1.6383504    
    133000   305.06495      222.24614      317.3599       539.60603      3267.2395      3944.9461      1.6463439    
    134000   303.96701      192.02526      316.2177       508.24297      3591.1725      3894.5802      1.6676349    
    135000   318.68188      207.00701      331.52563      538.53264     -520.21232      3971.0203      1.6355338    
    136000   308.63841      207.39649      321.07737      528.47387     -87.839369      3933.2137      1.6512548    
    137000   337.32634      224.00307      350.92151      574.92458     -886.06575      3941.7757      1.6476681    
    138000   301.68831      214.7862       313.84717      528.63337      262.4753       3943.7697      1.646835     
    139000   301.84762      197.68072      314.0129       511.69361      4242.0588      3948.6541      1.6447979    
    140000   307.1823       216.53894      319.56257      536.10151     -5715.8301      3981.1934      1.6313546    
    141000   286.48618      206.58313      298.03235      504.61548     -5047.9003      3980.2555      1.631739     
    142000   307.36948      226.72376      319.7573       546.48107     -8133.1024      3957.2052      1.6412436    
    143000   298.40965      220.77309      310.43637      531.20946      4340.4579      3922.8527      1.6556161    
    144000   291.89677      214.90211      303.661        518.56311      2306.2291      3975.2793      1.6337815    
    145000   308.45615      212.7401       320.88777      533.62787      1571.0524      3940.6236      1.6481498    
    146000   302.07713      229.34477      314.25166      543.59642     -919.87862      3944.0253      1.6467283    
    147000   309.05547      226.69557      321.51124      548.20681     -3799.542       3956.828       1.6414001    
    148000   299.07662      224.66594      311.13022      535.79616     -3795.2974      3970.2213      1.635863     
    149000   319.90679      220.95945      332.7999       553.75934     -2550.2584      3942.3299      1.6474364    
    150000   298.64615      203.59013      310.6824       514.27253     -2301.8827      3961.7408      1.6393647    
    151000   310.33664      233.74494      322.84404      556.58899      1417.4201      4000.2964      1.6235642    
    152000   296.61553      210.71926      308.56994      519.2892       1085.4722      3993.2215      1.6264407    
    153000   312.67367      237.13906      325.27527      562.41432      7453.9546      3941.7641      1.6476729    
    154000   304.05337      225.53385      316.30754      541.84139      250.07596      3949.6088      1.6444003    
    155000   302.43496      210.93748      314.62391      525.56139     -3170.9926      3998.2674      1.6243881    
    156000   314.62872      223.85392      327.3091       551.16302      93.581211      3978.3892      1.6325044    
    157000   301.08547      221.79443      313.22003      535.01446     -1002.9464      3975.7677      1.6335808    
    158000   315.65137      227.5109       328.37297      555.88388      2692.0777      3994.3209      1.625993     
    159000   290.55578      222.44676      302.26596      524.71272     -1224.3468      3942.3024      1.6474479    
    160000   274.08416      216.22149      285.1305       501.35198      496.97407      3999.1419      1.6240329    
    161000   312.31002      224.212        324.89696      549.10896     -333.69779      3968.1735      1.6367072    
    162000   302.63022      230.47501      314.82703      545.30204      5947.456       3922.1797      1.6559002    
    163000   316.91613      230.73237      329.68871      560.42108     -2194.4649      3979.674       1.6319774    
    164000   307.33779      202.81298      319.72433      522.53731     -2907.1801      3971.1077      1.6354978    
    165000   299.18715      201.09627      311.2452       512.34148      3811.8412      3939.1264      1.6487762    
    166000   283.73868      231.45485      295.17412      526.62897      1887.1258      3948.4142      1.6448978    
    167000   295.13825      209.13575      307.03312      516.16887      3783.3815      3943.52        1.6469393    
    168000   312.98045      226.18056      325.59441      551.77497      911.98949      3987.1354      1.6289233    
    169000   289.97369      224.24874      301.66042      525.90915      4537.6725      3934.0135      1.6509191    
    170000   295.1577       216.33114      307.05335      523.38449     -376.88824      3992.5706      1.6267058    
    171000   297.46924      202.17536      309.45805      511.63341      2353.1474      3981.1353      1.6313783    
    172000   286.92028      245.36924      298.48394      543.85318      3706.5413      3963.3116      1.6387149    
    173000   286.38991      225.2477       297.9322       523.1799       450.11607      3963.2333      1.6387473    
    174000   316.24441      215.6859       328.98992      544.67581      3926.0969      3988.741       1.6282676    
    175000   294.63537      226.71968      306.50997      533.22965      2473.0452      3969.558       1.6361363    
    176000   319.67712      228.84125      332.56098      561.40223      832.85504      4000.4917      1.6234849    
    177000   328.30641      184.2786       341.53805      525.81665     -423.63721      3978.3913      1.6325035    
    178000   307.49289      212.27481      319.88568      532.1605       971.77362      3972.3937      1.6349683    
    179000   303.4506       230.69392      315.68048      546.3744       4135.041       3965.4782      1.6378196    
    180000   293.05535      218.21101      304.86628      523.07729     -2620.874       3968.4652      1.6365868    
    181000   331.80495      245.47235      345.17758      590.64994      3023.4104      3974.3303      1.6341716    
    182000   279.15548      237.50298      290.4062       527.90918     -567.08259      3966.1244      1.6375527    
    183000   297.79448      223.81609      309.7964       533.6125       3835.9509      3973.6631      1.634446     
    184000   291.27253      201.71166      303.0116       504.72326      2152.839       3937.4143      1.6494932    
    185000   306.71776      187.27026      319.07932      506.34958     -3048.6373      3966.4445      1.6374206    
    186000   301.04107      215.77625      313.17384      528.95009      4920.5405      3937.0032      1.6496654    
    187000   312.17696      220.33826      324.75853      545.09679     -2537.0131      4003.2751      1.6223562    
    188000   280.22793      202.70519      291.52188      494.22707      233.83182      3978.697       1.6323781    
    189000   302.75486      234.46432      314.9567       549.42101     -1034.4539      3985.2852      1.6296796    
    190000   278.1254       234.31688      289.33461      523.65148      3467.381       3958.0621      1.6408883    
    191000   312.73418      232.2536       325.33821      557.59181     -2134.6554      4001.2164      1.6231909    
    192000   281.67233      240.71723      293.02449      533.74172      2897.0584      4002.2833      1.6227582    
    193000   295.21558      229.41391      307.11356      536.52747     -1155.9239      3973.9847      1.6343138    
    194000   303.34348      196.70434      315.56904      512.27338     -205.68723      4008.9355      1.6200655    
    195000   286.86506      232.22894      298.4265       530.65544     -4223.2796      3954.8269      1.6422306    
    196000   300.59506      202.41082      312.70986      515.12068      1961.2163      3961.3695      1.6395183    
    197000   305.46867      231.87843      317.77988      549.65831      1063.4584      3990.4883      1.6275547    
    198000   309.67924      217.0544       322.16015      539.21455     -2288.4219      3975.8975      1.6335275    
    199000   279.01219      217.29312      290.25713      507.55025     -9311.8312      4026.2896      1.6130827    
    200000   322.41234      208.21123      335.40643      543.61766     -2012.4732      3985.1003      1.6297552    
    200066   289.14194      241.13817      300.79514      541.93331     -935.58576      4017.7129      1.6165261    
Loop time of 24.3967 on 1 procs for 100000 steps with 350 atoms

Performance: 354.146 ns/day, 0.068 hours/ns, 4098.910 timesteps/s, 1.435 Matom-step/s
99.8% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 13.13      | 13.13      | 13.13      |   0.0 | 53.82
Bond    | 4.5733     | 4.5733     | 4.5733     |   0.0 | 18.75
Neigh   | 4.7735     | 4.7735     | 4.7735     |   0.0 | 19.57
Comm    | 0.52598    | 0.52598    | 0.52598    |   0.0 |  2.16
Output  | 0.50167    | 0.50167    | 0.50167    |   0.0 |  2.06
Modify  | 0.76106    | 0.76106    | 0.76106    |   0.0 |  3.12
Other   |            | 0.1312     |            |       |  0.54

Nlocal:            350 ave         350 max         350 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2100 ave        2100 max        2100 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          20648 ave       20648 max       20648 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 20648
Ave neighs/atom = 58.994286
Ave special neighs/atom = 6.1942857
Neighbor list builds = 2169
Dangerous builds = 0
unfix           npt_relax

# fix nvt_heat    all nvt temp 300 1000 ${thermal_damp}
# run 100000      # 100 picoseconds
# unfix           nvt_heat
#
# fix npt_heat    all npt temp 1000 1000 ${thermal_damp} iso 0 0 ${pressure_damp}
# run 100000      # 100 picoseconds
# unfix           npt_heat
#
# fix cooling_npt all npt temp 1000 300 ${thermal_damp} iso 0 0 ${pressure_damp}
# run 700000      # 700 picoseconds
# unfix           cooling_npt
#
# fix npt_final   all npt temp 300 300 ${thermal_damp} iso 0 0 100
# run 100000      # 100 picoseconds
# unfix           npt_final

# density computation
variable rho equal density
fix integrate  all npt temp ${temp} ${temp} ${thermal_damp} iso 0 0 ${pressure_damp}
fix integrate  all npt temp 300 ${temp} ${thermal_damp} iso 0 0 ${pressure_damp}
fix integrate  all npt temp 300 300 ${thermal_damp} iso 0 0 ${pressure_damp}
fix integrate  all npt temp 300 300 100.0 iso 0 0 ${pressure_damp}
fix integrate  all npt temp 300 300 100.0 iso 0 0 500.0
fix rho50k all ave/time 10 5000 50000 v_rho mode scalar ave one
run 50000
Generated 6 of 6 mixed pair_coeff terms from arithmetic mixing rule
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
Per MPI rank memory allocation (min/avg/max) = 19.47 | 19.47 | 19.47 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Density    
    200066   289.14194      241.13817      300.79514      541.93331     -935.58576      4017.7129      1.6165261    
    201000   298.73707      234.00289      310.77699      544.77988     -1256.0531      3999.9811      1.6236921    
    202000   298.4365       199.51314      310.46429      509.97744     -5048.5635      4016.1839      1.6171416    
    203000   287.07055      240.14548      298.64027      538.78575     -141.9279       3979.3388      1.6321148    
    204000   302.50614      190.82172      314.69795      505.51967      6271.5689      3959.5296      1.6402802    
    205000   319.00207      215.14895      331.85871      547.00766      5224.8632      3994.3466      1.6259826    
    206000   308.44254      189.52492      320.87361      510.39854     -1391.4898      3999.4701      1.6238996    
    207000   316.77541      234.70156      329.54231      564.24387     -2868.1598      3976.9234      1.6331061    
    208000   283.52686      235.95293      294.95376      530.90669     -6673.0021      4019.2309      1.6159156    
    209000   315.20793      201.98341      327.91166      529.89508      8155.6259      3950.7069      1.6439432    
    210000   305.6226       237.66979      317.94002      555.60981     -2894.441       4011.4776      1.6190388    
    211000   302.41708      206.44918      314.6053       521.05448      116.83924      3984.0834      1.6301712    
    212000   294.39022      222.16372      306.25494      528.41866      4321.8859      3942.4743      1.6473761    
    213000   297.81551      201.81981      309.81828      511.63809      1593.0721      3948.6315      1.6448073    
    214000   301.26744      231.09619      313.40933      544.50552     -5178.2287      3988.6634      1.6282993    
    215000   316.28249      234.97901      329.02953      564.00854     -15.242322      3952.3883      1.6432439    
    216000   305.34019      208.27963      317.64623      525.92586     -2691.0435      3990.993       1.6273488    
    217000   325.79509      222.09865      338.92551      561.02416     -3952.0007      3992.9555      1.626549     
    218000   291.8491       237.98833      303.61141      541.59974     -595.24854      3965.3655      1.6378661    
    219000   280.79306      228.63554      292.10978      520.74531     -3338.5581      4010.9199      1.6192639    
    220000   302.23108      191.39348      314.41181      505.80529     -1753.1053      3963.2472      1.6387416    
    221000   298.76919      222.80758      310.8104       533.61797      4457.8347      3955.8668      1.6417989    
    222000   305.81087      258.72532      318.13588      576.8612      -1441.4811      4012.7082      1.6185423    
    223000   305.99389      211.0515       318.32627      529.37777      2295.6769      3985.0319      1.6297832    
    224000   298.11639      221.94707      310.13128      532.07836     -2378.5504      3968.9054      1.6364053    
    225000   283.76317      220.31811      295.19959      515.5177      -2933.8127      4004.03        1.6220503    
    226000   307.46906      231.05608      319.86089      550.91697     -826.50096      3972.3996      1.6349659    
    227000   302.22696      208.65968      314.40752      523.0672      -4023.7247      4004.4055      1.6218982    
    228000   293.81123      213.29815      305.65262      518.95077      1136.2179      3988.5024      1.6283651    
    229000   310.46512      204.19423      322.97771      527.17193     -234.68509      3958.3589      1.6407653    
    230000   286.58772      235.45671      298.13798      533.59469     -884.08927      3987.1422      1.6289205    
    231000   275.50463      200.29171      286.60821      486.89992      5080.1989      3984.94        1.6298207    
    232000   296.18994      221.4232       308.1272       529.5504       2102.6994      4008.2196      1.6203548    
    233000   324.32742      212.5155       337.39869      549.91419      6181.5789      3976.5952      1.6332409    
    234000   277.4662       221.13099      288.64884      509.77983     -1430.3274      3992.2869      1.6268214    
    235000   283.21935      222.17616      294.63386      516.81002     -2440.3003      3988.3042      1.628446     
    236000   298.01676      225.67767      310.02764      535.70531      742.12389      4015.0123      1.6176135    
    237000   284.91174      218.0602       296.39446      514.45466      4249.309       3953.7661      1.6426712    
    238000   306.19307      229.94404      318.53348      548.47752      8631.2777      3959.328       1.6403637    
    239000   294.63062      209.17628      306.50503      515.68131     -5006.2696      3995.4208      1.6255454    
    240000   286.94516      252.44144      298.50983      550.95127     -4775.9017      3979.045       1.6322354    
    241000   279.88211      199.55066      291.16211      490.71277      2050.2074      3988.2867      1.6284531    
    242000   302.6356       205.74095      314.83264      520.57358      3309.0798      3975.6564      1.6336266    
    243000   287.54685      216.72137      299.13576      515.85713     -5202.8069      4004.4025      1.6218994    
    244000   283.16871      221.89864      294.58118      516.47982     -1041.784       3969.1518      1.6363037    
    245000   303.55965      234.84813      315.79392      550.64205     -665.43167      3977.6698      1.6327997    
    246000   294.39666      238.38125      306.26164      544.64289     -2023.4422      3994.6118      1.6258746    
    247000   284.87871      212.15132      296.36009      508.51141     -3864.3047      3964.6212      1.6381736    
    248000   308.44768      216.56311      320.87896      537.44208     -759.28119      3998.949       1.6241112    
    249000   300.47739      185.67134      312.58744      498.25878      4005.5224      3967.669       1.6369153    
    250000   297.45925      222.94001      309.44766      532.38767     -3670.9881      3958.5124      1.6407017    
    250066   285.97298      231.33827      297.49846      528.83673      5569.035       3960.9032      1.6397114    
Loop time of 11.6142 on 1 procs for 50000 steps with 350 atoms

Performance: 371.958 ns/day, 0.065 hours/ns, 4305.068 timesteps/s, 1.507 Matom-step/s
99.7% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 6.2215     | 6.2215     | 6.2215     |   0.0 | 53.57
Bond    | 2.1772     | 2.1772     | 2.1772     |   0.0 | 18.75
Neigh   | 2.2973     | 2.2973     | 2.2973     |   0.0 | 19.78
Comm    | 0.25285    | 0.25285    | 0.25285    |   0.0 |  2.18
Output  | 0.23958    | 0.23958    | 0.23958    |   0.0 |  2.06
Modify  | 0.36262    | 0.36262    | 0.36262    |   0.0 |  3.12
Other   |            | 0.06318    |            |       |  0.54

Nlocal:            350 ave         350 max         350 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2086 ave        2086 max        2086 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          21007 ave       21007 max       21007 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 21007
Ave neighs/atom = 60.02
Ave special neighs/atom = 6.1942857
Neighbor list builds = 1097
Dangerous builds = 0
unfix integrate
unfix rho50k

# Compute initial state
fix 3 all box/relax  aniso 0.0
minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 6 of 6 mixed pair_coeff terms from arithmetic mixing rule
WARNING: Energy due to 3 extra global DOFs will be included in minimizer energies
 (src/min.cpp:222)
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
Per MPI rank memory allocation (min/avg/max) = 20.58 | 20.58 | 20.58 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Density    
    250066   285.97298      231.33827      297.49846      528.83673      5569.035       3960.9032      1.6397114    
    250082   285.97298      231.05782      297.49846      528.55628      5378.8554      3961.5103      1.6394601    
Loop time of 0.0516322 on 1 procs for 16 steps with 350 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
       231.33826557801   231.057817857453   231.057817857453
  Force two-norm initial, final = 789.45563 775.53819
  Force max component initial, final = 417.84483 393.40113
  Final line search alpha, max atom move = 1.5151112e-14 5.9604645e-12
  Iterations, force evaluations = 16 186

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.034293   | 0.034293   | 0.034293   |   0.0 | 66.42
Bond    | 0.010831   | 0.010831   | 0.010831   |   0.0 | 20.98
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.0010358  | 0.0010358  | 0.0010358  |   0.0 |  2.01
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.005472   |            |       | 10.60

Nlocal:            350 ave         350 max         350 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2092 ave        2092 max        2092 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          20969 ave       20969 max       20969 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 20969
Ave neighs/atom = 59.911429
Ave special neighs/atom = 6.1942857
Neighbor list builds = 0
Dangerous builds = 0

variable tmp equal pxx
variable pxx0 equal ${tmp}
variable pxx0 equal 877.909483202238
variable tmp equal pyy
variable pyy0 equal ${tmp}
variable pyy0 equal 4820.71878563472
variable tmp equal pzz
variable pzz0 equal ${tmp}
variable pzz0 equal 10437.9380307898
variable tmp equal pyz
variable pyz0 equal ${tmp}
variable pyz0 equal 3062.3213831941
variable tmp equal pxz
variable pxz0 equal ${tmp}
variable pxz0 equal 1020.10531281141
variable tmp equal pxy
variable pxy0 equal ${tmp}
variable pxy0 equal -879.603077083995

variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.5057201988007
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 14.7586388725461
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.311015182669

# These formulas define the derivatives w.r.t. strain components
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1-877.909483202238)/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1-877.909483202238)/(v_delta/v_len0)*0.0001
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1-4820.71878563472)/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1-4820.71878563472)/(v_delta/v_len0)*0.0001
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${cfac}
variable d3 equal -(v_pzz1-10437.9380307898)/(v_delta/v_len0)*${cfac}
variable d3 equal -(v_pzz1-10437.9380307898)/(v_delta/v_len0)*0.0001
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${cfac}
variable d4 equal -(v_pyz1-3062.3213831941)/(v_delta/v_len0)*${cfac}
variable d4 equal -(v_pyz1-3062.3213831941)/(v_delta/v_len0)*0.0001
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${cfac}
variable d5 equal -(v_pxz1-1020.10531281141)/(v_delta/v_len0)*${cfac}
variable d5 equal -(v_pxz1-1020.10531281141)/(v_delta/v_len0)*0.0001
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1--879.603077083995)/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1--879.603077083995)/(v_delta/v_len0)*0.0001

# displace_atoms all random ${atomjiggle} ${atomjiggle} ${atomjiggle} 87287 units box

# Write restart
unfix 3
write_restart restart_333U-50C-20-vasp.equil
System init for write_restart ...
Generated 6 of 6 mixed pair_coeff terms from arithmetic mixing rule

# uxx Perturbation

variable dir equal 1
include ./input/displace_333U-50C-20-vasp.mod
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 15.5057201988007
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart_333U-50C-20-vasp.equil
Reading restart file ...
  restart file = 10 Sep 2025, LAMMPS = 10 Sep 2025
  restoring atom style full from restart
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.371963 14.630725 17.159756) with tilt (-6.373215 -0.4561576 -0.65341273)
  1 by 1 by 1 MPI processor grid
  restoring pair style lj/cut from restart
  restoring bond style harmonic from restart
  restoring angle style hybrid from restart
  restoring dihedral style harmonic from restart
  350 atoms
  375 bonds
  709 angles
  879 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
include ./input/angles_333U-50C-20-vasp.mod
angle_style hybrid fourier cosine/periodic
angle_coeff 1 fourier 58.020602        0.343737        0.374972        0.281246
angle_coeff 2 fourier 157.882480        0.343737        0.374972        0.281246
angle_coeff 3 fourier 83.380072        0.343737        0.374972        0.281246
angle_coeff 4 fourier 221.735285        0.343737        0.374972        0.281246
angle_coeff 5 fourier 114.246973        0.343737        0.374972        0.281246
angle_coeff 6 fourier 32.417871        0.343737        0.374972        0.281246
angle_coeff 7 fourier 90.420412        0.343737        0.374972        0.281246
angle_coeff 8 fourier 75.498766        0.343737        0.374972        0.281246
angle_coeff 9 cosine/periodic 88.853997              -1               3

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.02*${len0}
variable delta equal -0.02*15.5057201988007
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.02*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.02*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.310114403976014 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.310114403976014 xy delta 0.127464300226057 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.310114403976014 xy delta 0.127464300226057 xz delta 0.00912315192437961 remap units box
Changing box ...
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.061849 14.630725 17.159756) with tilt (-6.373215 -0.4561576 -0.65341273)
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.061849 14.630725 17.159756) with tilt (-6.2457507 -0.4561576 -0.65341273)
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.061849 14.630725 17.159756) with tilt (-6.2457507 -0.44703444 -0.65341273)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 6 of 6 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 7 5 5
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
Per MPI rank memory allocation (min/avg/max) = 19.5 | 19.5 | 19.5 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
    250082   285.97298     -414.51596      672.03224      555.01474      30829.435    
    250110   285.97298     -455.84455      361.68384      203.33775      8423.1355    
Loop time of 0.0276141 on 1 procs for 28 steps with 350 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
      257.516275614789   -94.160710807283   -94.160710807283
  Force two-norm initial, final = 673.06799 26.574591
  Force max component initial, final = 83.511289 5.8430571
  Final line search alpha, max atom move = 1.6470444e-11 9.6237746e-11
  Iterations, force evaluations = 28 113

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.020993   | 0.020993   | 0.020993   |   0.0 | 76.02
Bond    | 0.0055045  | 0.0055045  | 0.0055045  |   0.0 | 19.93
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00065047 | 0.00065047 | 0.00065047 |   0.0 |  2.36
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.000466   |            |       |  1.69

Nlocal:            350 ave         350 max         350 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2108 ave        2108 max        2108 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          21377 ave       21377 max       21377 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 21377
Ave neighs/atom = 61.077143
Ave special neighs/atom = 6.1942857
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 12308.0907607216
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 5567.34329103231
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 7393.9723039276
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 715.464225779329
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 1912.28733073506
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 1413.01953173368

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 57.1509063875968
variable C2neg equal ${d2}
variable C2neg equal 3.73312252698795
variable C3neg equal ${d3}
variable C3neg equal -15.219828634311
variable C4neg equal ${d4}
variable C4neg equal -8.2465092573021
variable C5neg equal ${d5}
variable C5neg equal 4.46091008961825
variable C6neg equal ${d6}
variable C6neg equal 7.97533651431662

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart_333U-50C-20-vasp.equil
Reading restart file ...
  restart file = 10 Sep 2025, LAMMPS = 10 Sep 2025
  restoring atom style full from restart
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.371963 14.630725 17.159756) with tilt (-6.373215 -0.4561576 -0.65341273)
  1 by 1 by 1 MPI processor grid
  restoring pair style lj/cut from restart
  restoring bond style harmonic from restart
  restoring angle style hybrid from restart
  restoring dihedral style harmonic from restart
  350 atoms
  375 bonds
  709 angles
  879 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
include ./input/angles_333U-50C-20-vasp.mod
angle_style hybrid fourier cosine/periodic
angle_coeff 1 fourier 58.020602        0.343737        0.374972        0.281246
angle_coeff 2 fourier 157.882480        0.343737        0.374972        0.281246
angle_coeff 3 fourier 83.380072        0.343737        0.374972        0.281246
angle_coeff 4 fourier 221.735285        0.343737        0.374972        0.281246
angle_coeff 5 fourier 114.246973        0.343737        0.374972        0.281246
angle_coeff 6 fourier 32.417871        0.343737        0.374972        0.281246
angle_coeff 7 fourier 90.420412        0.343737        0.374972        0.281246
angle_coeff 8 fourier 75.498766        0.343737        0.374972        0.281246
angle_coeff 9 cosine/periodic 88.853997              -1               3

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.02*${len0}
variable delta equal 0.02*15.5057201988007
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.02*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.02*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.310114403976014 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.310114403976014 xy delta -0.127464300226057 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.310114403976014 xy delta -0.127464300226057 xz delta -0.00912315192437961 remap units box
Changing box ...
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.682078 14.630725 17.159756) with tilt (-6.373215 -0.4561576 -0.65341273)
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.682078 14.630725 17.159756) with tilt (-6.5006793 -0.4561576 -0.65341273)
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.682078 14.630725 17.159756) with tilt (-6.5006793 -0.46528075 -0.65341273)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 6 of 6 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 7 5 5
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
Per MPI rank memory allocation (min/avg/max) = 19.5 | 19.5 | 19.5 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
    250082   285.97298     -442.07918      708.27833      563.69761     -19209.914    
    250117   285.97298     -476.72771      394.09211      214.86286     -6664.6809    
Loop time of 0.0296779 on 1 procs for 35 steps with 350 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
      266.199145345315  -82.6356055682996  -82.6356055682996
  Force two-norm initial, final = 681.16876 21.530359
  Force max component initial, final = 99.971675 3.3444476
  Final line search alpha, max atom move = 1.6963713e-11 5.6734247e-11
  Iterations, force evaluations = 35 127

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.022284   | 0.022284   | 0.022284   |   0.0 | 75.09
Bond    | 0.0061839  | 0.0061839  | 0.0061839  |   0.0 | 20.84
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00068336 | 0.00068336 | 0.00068336 |   0.0 |  2.30
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0005264  |            |       |  1.77

Nlocal:            350 ave         350 max         350 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2060 ave        2060 max        2060 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          20527 ave       20527 max       20527 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 20527
Ave neighs/atom = 58.648571
Ave special neighs/atom = 6.1942857
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -82.6356055682996
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -6664.68091176373
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -14120.4216072603
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -3347.40929708503
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal -2526.21183094588
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 799.29921266833
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 2535.03027741481
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 995.730026556907

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 74.9916554523127
variable C2pos equal ${d2}
variable C2pos equal 40.8406404135988
variable C3pos equal ${d3}
variable C3pos equal 64.8207493086784
variable C4pos equal ${d4}
variable C4pos equal 10.332956783186
variable C5pos equal ${d5}
variable C5pos equal -7.574624823017
variable C6pos equal ${d6}
variable C6pos equal -8.39451144876163

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(57.1509063875968+${C1pos})
variable C11 equal 0.5*(57.1509063875968+74.9916554523127)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(3.73312252698795+${C2pos})
variable C21 equal 0.5*(3.73312252698795+40.8406404135988)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(-15.219828634311+${C3pos})
variable C31 equal 0.5*(-15.219828634311+64.8207493086784)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-8.2465092573021+${C4pos})
variable C41 equal 0.5*(-8.2465092573021+10.332956783186)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(4.46091008961825+${C5pos})
variable C51 equal 0.5*(4.46091008961825+-7.574624823017)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(7.97533651431662+${C6pos})
variable C61 equal 0.5*(7.97533651431662+-8.39451144876163)

# Delete dir to make sure it is not reused

variable dir delete

# uyy Perturbation

variable dir equal 2
include ./input/displace_333U-50C-20-vasp.mod
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 14.7586388725461
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart_333U-50C-20-vasp.equil
Reading restart file ...
  restart file = 10 Sep 2025, LAMMPS = 10 Sep 2025
  restoring atom style full from restart
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.371963 14.630725 17.159756) with tilt (-6.373215 -0.4561576 -0.65341273)
  1 by 1 by 1 MPI processor grid
  restoring pair style lj/cut from restart
  restoring bond style harmonic from restart
  restoring angle style hybrid from restart
  restoring dihedral style harmonic from restart
  350 atoms
  375 bonds
  709 angles
  879 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.001 seconds
include ./input/angles_333U-50C-20-vasp.mod
angle_style hybrid fourier cosine/periodic
angle_coeff 1 fourier 58.020602        0.343737        0.374972        0.281246
angle_coeff 2 fourier 157.882480        0.343737        0.374972        0.281246
angle_coeff 3 fourier 83.380072        0.343737        0.374972        0.281246
angle_coeff 4 fourier 221.735285        0.343737        0.374972        0.281246
angle_coeff 5 fourier 114.246973        0.343737        0.374972        0.281246
angle_coeff 6 fourier 32.417871        0.343737        0.374972        0.281246
angle_coeff 7 fourier 90.420412        0.343737        0.374972        0.281246
angle_coeff 8 fourier 75.498766        0.343737        0.374972        0.281246
angle_coeff 9 cosine/periodic 88.853997              -1               3

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.02*${len0}
variable delta equal -0.02*14.7586388725461
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.02*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.02*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.295172777450922 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.295172777450922 yz delta 0.0130682546901066 remap units box
Changing box ...
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.371963 14.335552 17.159756) with tilt (-6.373215 -0.4561576 -0.65341273)
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.371963 14.335552 17.159756) with tilt (-6.373215 -0.4561576 -0.64034448)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 6 of 6 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 7 5 5
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
Per MPI rank memory allocation (min/avg/max) = 19.51 | 19.51 | 19.51 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
    250082   285.97298     -414.39343      676.41384      559.51888      30286.2      
    250126   285.97298     -462.71965      365.35643      200.13524      5953.4782    
Loop time of 0.0355325 on 1 procs for 44 steps with 350 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
      262.020415250504  -97.3632178722661  -97.3632178722661
  Force two-norm initial, final = 664.40779 16.276609
  Force max component initial, final = 94.080543 1.9846909
  Final line search alpha, max atom move = 4.2190455e-11 8.3735011e-11
  Iterations, force evaluations = 44 143

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.026964   | 0.026964   | 0.026964   |   0.0 | 75.89
Bond    | 0.0071179  | 0.0071179  | 0.0071179  |   0.0 | 20.03
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00080705 | 0.00080705 | 0.00080705 |   0.0 |  2.27
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0006434  |            |       |  1.81

Nlocal:            350 ave         350 max         350 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2144 ave        2144 max        2144 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          21414 ave       21414 max       21414 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 21414
Ave neighs/atom = 61.182857
Ave special neighs/atom = 6.1942857
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 1928.1473108172
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 9919.41547109394
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 6012.8717962263
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 845.06953918345
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 1613.07884577217
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 594.933433660987

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 5.25118913807481
variable C2neg equal ${d2}
variable C2neg equal 25.4934834272961
variable C3neg equal ${d3}
variable C3neg equal -22.1253311728175
variable C4neg equal ${d4}
variable C4neg equal -12.3369397476656
variable C5neg equal ${d5}
variable C5neg equal 2.9648676648038
variable C6neg equal ${d6}
variable C6neg equal 8.62336308133722

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart_333U-50C-20-vasp.equil
Reading restart file ...
  restart file = 10 Sep 2025, LAMMPS = 10 Sep 2025
  restoring atom style full from restart
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.371963 14.630725 17.159756) with tilt (-6.373215 -0.4561576 -0.65341273)
  1 by 1 by 1 MPI processor grid
  restoring pair style lj/cut from restart
  restoring bond style harmonic from restart
  restoring angle style hybrid from restart
  restoring dihedral style harmonic from restart
  350 atoms
  375 bonds
  709 angles
  879 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.001 seconds
include ./input/angles_333U-50C-20-vasp.mod
angle_style hybrid fourier cosine/periodic
angle_coeff 1 fourier 58.020602        0.343737        0.374972        0.281246
angle_coeff 2 fourier 157.882480        0.343737        0.374972        0.281246
angle_coeff 3 fourier 83.380072        0.343737        0.374972        0.281246
angle_coeff 4 fourier 221.735285        0.343737        0.374972        0.281246
angle_coeff 5 fourier 114.246973        0.343737        0.374972        0.281246
angle_coeff 6 fourier 32.417871        0.343737        0.374972        0.281246
angle_coeff 7 fourier 90.420412        0.343737        0.374972        0.281246
angle_coeff 8 fourier 75.498766        0.343737        0.374972        0.281246
angle_coeff 9 cosine/periodic 88.853997              -1               3

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.02*${len0}
variable delta equal 0.02*14.7586388725461
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.02*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.02*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.295172777450922 yz delta ${deltayz} remap units box
change_box all y delta 0 0.295172777450922 yz delta -0.0130682546901066 remap units box
Changing box ...
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.371963 14.925898 17.159756) with tilt (-6.373215 -0.4561576 -0.65341273)
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.371963 14.925898 17.159756) with tilt (-6.373215 -0.4561576 -0.66648099)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 6 of 6 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 7 5 5
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
Per MPI rank memory allocation (min/avg/max) = 19.5 | 19.5 | 19.5 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
    250082   285.97298     -443.06537      702.84769      557.28078     -18707.111    
    250117   285.97298     -471.72758      387.19912      212.97        -5783.812     
Loop time of 0.0302367 on 1 procs for 35 steps with 350 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
      259.782318916275  -84.5284652109758  -84.5284652109758
  Force two-norm initial, final = 688.68321 19.760926
  Force max component initial, final = 80.164785 2.6509263
  Final line search alpha, max atom move = 1.8439187e-11 4.8880927e-11
  Iterations, force evaluations = 35 126

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.022659   | 0.022659   | 0.022659   |   0.0 | 74.94
Bond    | 0.0063668  | 0.0063668  | 0.0063668  |   0.0 | 21.06
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00067455 | 0.00067455 | 0.00067455 |   0.0 |  2.23
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0005363  |            |       |  1.77

Nlocal:            350 ave         350 max         350 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2072 ave        2072 max        2072 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          20512 ave       20512 max       20512 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 20512
Ave neighs/atom = 58.605714
Ave special neighs/atom = 6.1942857
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -84.5284652109758
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -5783.8120375833
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -6049.3871383047
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -9132.15461585846
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal -2169.89435858673
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 1080.21889435693
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 2129.47228799053
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 1255.26703709508

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 34.6364831075347
variable C2pos equal ${d2}
variable C2pos equal 69.7643670074659
variable C3pos equal ${d3}
variable C3pos equal 63.0391619468827
variable C4pos equal ${d4}
variable C4pos equal 9.0352717304951
variable C5pos equal ${d5}
variable C5pos equal -5.5468348758956
variable C6pos equal ${d6}
variable C6pos equal -9.79910985720463

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(5.25118913807481+${C1pos})
variable C12 equal 0.5*(5.25118913807481+34.6364831075347)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(25.4934834272961+${C2pos})
variable C22 equal 0.5*(25.4934834272961+69.7643670074659)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(-22.1253311728175+${C3pos})
variable C32 equal 0.5*(-22.1253311728175+63.0391619468827)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-12.3369397476656+${C4pos})
variable C42 equal 0.5*(-12.3369397476656+9.0352717304951)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(2.9648676648038+${C5pos})
variable C52 equal 0.5*(2.9648676648038+-5.5468348758956)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(8.62336308133722+${C6pos})
variable C62 equal 0.5*(8.62336308133722+-9.79910985720463)

# Delete dir to make sure it is not reused

variable dir delete

# uzz Perturbation

variable dir equal 3
include ./input/displace_333U-50C-20-vasp.mod
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.311015182669
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart_333U-50C-20-vasp.equil
Reading restart file ...
  restart file = 10 Sep 2025, LAMMPS = 10 Sep 2025
  restoring atom style full from restart
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.371963 14.630725 17.159756) with tilt (-6.373215 -0.4561576 -0.65341273)
  1 by 1 by 1 MPI processor grid
  restoring pair style lj/cut from restart
  restoring bond style harmonic from restart
  restoring angle style hybrid from restart
  restoring dihedral style harmonic from restart
  350 atoms
  375 bonds
  709 angles
  879 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.001 seconds
include ./input/angles_333U-50C-20-vasp.mod
angle_style hybrid fourier cosine/periodic
angle_coeff 1 fourier 58.020602        0.343737        0.374972        0.281246
angle_coeff 2 fourier 157.882480        0.343737        0.374972        0.281246
angle_coeff 3 fourier 83.380072        0.343737        0.374972        0.281246
angle_coeff 4 fourier 221.735285        0.343737        0.374972        0.281246
angle_coeff 5 fourier 114.246973        0.343737        0.374972        0.281246
angle_coeff 6 fourier 32.417871        0.343737        0.374972        0.281246
angle_coeff 7 fourier 90.420412        0.343737        0.374972        0.281246
angle_coeff 8 fourier 75.498766        0.343737        0.374972        0.281246
angle_coeff 9 cosine/periodic 88.853997              -1               3

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.02*${len0}
variable delta equal -0.02*17.311015182669
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.02*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.02*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.34622030365338 remap units box
Changing box ...
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.371963 14.630725 16.813535) with tilt (-6.373215 -0.4561576 -0.65341273)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 6 of 6 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 7 5 5
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
Per MPI rank memory allocation (min/avg/max) = 19.5 | 19.5 | 19.5 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
    250082   285.97298     -411.26483      678.31378      564.54741      30998.613    
    250124   285.97298     -459.63776      365.56061      203.4213       6938.2626    
Loop time of 0.0346977 on 1 procs for 42 steps with 350 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
      267.048951561452  -94.0771564730449  -94.0771564730449
  Force two-norm initial, final = 672.3943 17.108568
  Force max component initial, final = 88.956812 2.133642
  Final line search alpha, max atom move = 3.7403664e-11 7.9806028e-11
  Iterations, force evaluations = 42 139

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.026335   | 0.026335   | 0.026335   |   0.0 | 75.90
Bond    | 0.007001   | 0.007001   | 0.007001   |   0.0 | 20.18
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00075463 | 0.00075463 | 0.00075463 |   0.0 |  2.17
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0006072  |            |       |  1.75

Nlocal:            350 ave         350 max         350 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2098 ave        2098 max        2098 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          21385 ave       21385 max       21385 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 21385
Ave neighs/atom = 61.1
Ave special neighs/atom = 6.1942857
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 2860.57081788836
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 4920.32108910312
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 13033.8959868479
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 2119.25207720395
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 454.782431581328
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 584.806522270653

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 9.91330667343061
variable C2neg equal ${d2}
variable C2neg equal 0.498011517342002
variable C3neg equal ${d3}
variable C3neg equal 12.9797897802905
variable C4neg equal ${d4}
variable C4neg equal -12.3875743046172
variable C5neg equal ${d5}
variable C5neg equal -2.82661440615041
variable C6neg equal ${d6}
variable C6neg equal 14.9942757714397

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart_333U-50C-20-vasp.equil
Reading restart file ...
  restart file = 10 Sep 2025, LAMMPS = 10 Sep 2025
  restoring atom style full from restart
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.371963 14.630725 17.159756) with tilt (-6.373215 -0.4561576 -0.65341273)
  1 by 1 by 1 MPI processor grid
  restoring pair style lj/cut from restart
  restoring bond style harmonic from restart
  restoring angle style hybrid from restart
  restoring dihedral style harmonic from restart
  350 atoms
  375 bonds
  709 angles
  879 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.001 seconds
include ./input/angles_333U-50C-20-vasp.mod
angle_style hybrid fourier cosine/periodic
angle_coeff 1 fourier 58.020602        0.343737        0.374972        0.281246
angle_coeff 2 fourier 157.882480        0.343737        0.374972        0.281246
angle_coeff 3 fourier 83.380072        0.343737        0.374972        0.281246
angle_coeff 4 fourier 221.735285        0.343737        0.374972        0.281246
angle_coeff 5 fourier 114.246973        0.343737        0.374972        0.281246
angle_coeff 6 fourier 32.417871        0.343737        0.374972        0.281246
angle_coeff 7 fourier 90.420412        0.343737        0.374972        0.281246
angle_coeff 8 fourier 75.498766        0.343737        0.374972        0.281246
angle_coeff 9 cosine/periodic 88.853997              -1               3

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.02*${len0}
variable delta equal 0.02*17.311015182669
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.02*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.02*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.34622030365338 remap units box
Changing box ...
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.371963 14.630725 17.505976) with tilt (-6.373215 -0.4561576 -0.65341273)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 6 of 6 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 7 5 6
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
Per MPI rank memory allocation (min/avg/max) = 19.5 | 19.5 | 19.5 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
    250082   285.97298     -447.46146      699.24311      549.28011     -19380.273    
    250117   285.97298     -474.61827      388.11329      210.99348     -6249.7634    
Loop time of 0.0301133 on 1 procs for 35 steps with 350 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
      251.781645884673  -86.5049792862929  -86.5049792862929
  Force two-norm initial, final = 679.98098 22.571925
  Force max component initial, final = 85.45216 2.9424957
  Final line search alpha, max atom move = 1.6196736e-11 4.7658825e-11
  Iterations, force evaluations = 35 126

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.02259    | 0.02259    | 0.02259    |   0.0 | 75.02
Bond    | 0.00633    | 0.00633    | 0.00633    |   0.0 | 21.02
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00067164 | 0.00067164 | 0.00067164 |   0.0 |  2.23
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0005212  |            |       |  1.73

Nlocal:            350 ave         350 max         350 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2068 ave        2068 max        2068 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          20499 ave       20499 max       20499 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 20499
Ave neighs/atom = 58.568571
Ave special neighs/atom = 6.1942857
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -86.5049792862929
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -6249.76340393605
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -6728.12551592639
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -3703.61057650088
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal -8317.55411938089
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -85.935644714357
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 3174.03343496969
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 1066.91147600091

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 38.0301749956431
variable C2pos equal ${d2}
variable C2pos equal 42.621646810678
variable C3pos equal ${d3}
variable C3pos equal 93.7774607508535
variable C4pos equal ${d4}
variable C4pos equal 9.97704953596595
variable C5pos equal ${d5}
variable C5pos equal -10.7696406107914
variable C6pos equal ${d6}
variable C6pos equal -3.96833716184819

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(9.91330667343061+${C1pos})
variable C13 equal 0.5*(9.91330667343061+38.0301749956431)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(0.498011517342002+${C2pos})
variable C23 equal 0.5*(0.498011517342002+42.621646810678)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(12.9797897802905+${C3pos})
variable C33 equal 0.5*(12.9797897802905+93.7774607508535)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-12.3875743046172+${C4pos})
variable C43 equal 0.5*(-12.3875743046172+9.97704953596595)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-2.82661440615041+${C5pos})
variable C53 equal 0.5*(-2.82661440615041+-10.7696406107914)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(14.9942757714397+${C6pos})
variable C63 equal 0.5*(14.9942757714397+-3.96833716184819)

# Delete dir to make sure it is not reused

variable dir delete

# uyz Perturbation

variable dir equal 4
include ./input/displace_333U-50C-20-vasp.mod
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.311015182669
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart_333U-50C-20-vasp.equil
Reading restart file ...
  restart file = 10 Sep 2025, LAMMPS = 10 Sep 2025
  restoring atom style full from restart
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.371963 14.630725 17.159756) with tilt (-6.373215 -0.4561576 -0.65341273)
  1 by 1 by 1 MPI processor grid
  restoring pair style lj/cut from restart
  restoring bond style harmonic from restart
  restoring angle style hybrid from restart
  restoring dihedral style harmonic from restart
  350 atoms
  375 bonds
  709 angles
  879 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.001 seconds
include ./input/angles_333U-50C-20-vasp.mod
angle_style hybrid fourier cosine/periodic
angle_coeff 1 fourier 58.020602        0.343737        0.374972        0.281246
angle_coeff 2 fourier 157.882480        0.343737        0.374972        0.281246
angle_coeff 3 fourier 83.380072        0.343737        0.374972        0.281246
angle_coeff 4 fourier 221.735285        0.343737        0.374972        0.281246
angle_coeff 5 fourier 114.246973        0.343737        0.374972        0.281246
angle_coeff 6 fourier 32.417871        0.343737        0.374972        0.281246
angle_coeff 7 fourier 90.420412        0.343737        0.374972        0.281246
angle_coeff 8 fourier 75.498766        0.343737        0.374972        0.281246
angle_coeff 9 cosine/periodic 88.853997              -1               3

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.02*${len0}
variable delta equal -0.02*17.311015182669
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.02*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.02*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.34622030365338 remap units box
Changing box ...
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.371963 14.630725 17.159756) with tilt (-6.373215 -0.4561576 -0.99963304)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 6 of 6 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 7 5 5
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
Per MPI rank memory allocation (min/avg/max) = 19.5 | 19.5 | 19.5 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
    250082   285.97298     -431.99708      679.13347      544.63485      4926.4734    
    250123   285.97298     -469.73436      376.72424      204.48833     -49.344225    
Loop time of 0.0330604 on 1 procs for 41 steps with 350 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
      247.136390720124  -93.0101261047236  -93.0101261047236
  Force two-norm initial, final = 669.02283 16.920856
  Force max component initial, final = 79.230212 2.4091725
  Final line search alpha, max atom move = 3.4251438e-11 8.2517622e-11
  Iterations, force evaluations = 41 138

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.025048   | 0.025048   | 0.025048   |   0.0 | 75.76
Bond    | 0.0066929  | 0.0066929  | 0.0066929  |   0.0 | 20.24
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00073898 | 0.00073898 | 0.00073898 |   0.0 |  2.24
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.000581   |            |       |  1.76

Nlocal:            350 ave         350 max         350 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2096 ave        2096 max        2096 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          20939 ave       20939 max       20939 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 20939
Ave neighs/atom = 59.825714
Ave special neighs/atom = 6.1942857
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -1953.92024283503
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 180.623609041553
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 1625.26395904692
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 882.673981754059
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 2009.42339100596
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 4310.06358265434

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal -14.1591486301863
variable C2neg equal ${d2}
variable C2neg equal -23.2004758829658
variable C3neg equal ${d3}
variable C3neg equal -44.0633703587144
variable C4neg equal ${d4}
variable C4neg equal 6.2387109973012
variable C5neg equal ${d5}
variable C5neg equal 4.94659039097275
variable C6neg equal ${d6}
variable C6neg equal 8.81138529419027

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart_333U-50C-20-vasp.equil
Reading restart file ...
  restart file = 10 Sep 2025, LAMMPS = 10 Sep 2025
  restoring atom style full from restart
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.371963 14.630725 17.159756) with tilt (-6.373215 -0.4561576 -0.65341273)
  1 by 1 by 1 MPI processor grid
  restoring pair style lj/cut from restart
  restoring bond style harmonic from restart
  restoring angle style hybrid from restart
  restoring dihedral style harmonic from restart
  350 atoms
  375 bonds
  709 angles
  879 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.001 seconds
include ./input/angles_333U-50C-20-vasp.mod
angle_style hybrid fourier cosine/periodic
angle_coeff 1 fourier 58.020602        0.343737        0.374972        0.281246
angle_coeff 2 fourier 157.882480        0.343737        0.374972        0.281246
angle_coeff 3 fourier 83.380072        0.343737        0.374972        0.281246
angle_coeff 4 fourier 221.735285        0.343737        0.374972        0.281246
angle_coeff 5 fourier 114.246973        0.343737        0.374972        0.281246
angle_coeff 6 fourier 32.417871        0.343737        0.374972        0.281246
angle_coeff 7 fourier 90.420412        0.343737        0.374972        0.281246
angle_coeff 8 fourier 75.498766        0.343737        0.374972        0.281246
angle_coeff 9 cosine/periodic 88.853997              -1               3

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.02*${len0}
variable delta equal 0.02*17.311015182669
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.02*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.02*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.34622030365338 remap units box
Changing box ...
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.371963 14.630725 17.159756) with tilt (-6.373215 -0.4561576 -0.30719243)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 6 of 6 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 7 5 5
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
Per MPI rank memory allocation (min/avg/max) = 19.5 | 19.5 | 19.5 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
    250082   285.97298     -428.79722      669.47781      538.17906      5478.4891    
    250114   285.97298     -466.80956      372.54086      203.22976      292.71498    
Loop time of 0.0302532 on 1 procs for 32 steps with 350 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
      240.680594458872  -94.2687031722155  -94.2687031722155
  Force two-norm initial, final = 663.12975 21.446231
  Force max component initial, final = 95.012436 3.2667571
  Final line search alpha, max atom move = 1.9952635e-11 6.5180412e-11
  Iterations, force evaluations = 32 121

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.022706   | 0.022706   | 0.022706   |   0.0 | 75.05
Bond    | 0.0062848  | 0.0062848  | 0.0062848  |   0.0 | 20.77
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00071345 | 0.00071345 | 0.00071345 |   0.0 |  2.36
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0005492  |            |       |  1.82

Nlocal:            350 ave         350 max         350 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2092 ave        2092 max        2092 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          20941 ave       20941 max       20941 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 20941
Ave neighs/atom = 59.831429
Ave special neighs/atom = 6.1942857
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -94.2687031722155
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 292.714984724025
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -2213.75311178227
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 1156.15296023055
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 1935.74510572379
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 1097.60732302347
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 1973.94780308132
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -2641.99957732173

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 15.4583129749225
variable C2pos equal ${d2}
variable C2pos equal 18.3228291270208
variable C3pos equal ${d3}
variable C3pos equal 42.51096462533
variable C4pos equal ${d4}
variable C4pos equal 28.5216048025791
variable C5pos equal ${d5}
variable C5pos equal -4.76921245134955
variable C6pos equal ${d6}
variable C6pos equal -9.88605200053732

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-14.1591486301863+${C1pos})
variable C14 equal 0.5*(-14.1591486301863+15.4583129749225)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(-23.2004758829658+${C2pos})
variable C24 equal 0.5*(-23.2004758829658+18.3228291270208)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-44.0633703587144+${C3pos})
variable C34 equal 0.5*(-44.0633703587144+42.51096462533)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(6.2387109973012+${C4pos})
variable C44 equal 0.5*(6.2387109973012+28.5216048025791)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(4.94659039097275+${C5pos})
variable C54 equal 0.5*(4.94659039097275+-4.76921245134955)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(8.81138529419027+${C6pos})
variable C64 equal 0.5*(8.81138529419027+-9.88605200053732)

# Delete dir to make sure it is not reused

variable dir delete

# uxz Perturbation

variable dir equal 5
include ./input/displace_333U-50C-20-vasp.mod
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.311015182669
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart_333U-50C-20-vasp.equil
Reading restart file ...
  restart file = 10 Sep 2025, LAMMPS = 10 Sep 2025
  restoring atom style full from restart
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.371963 14.630725 17.159756) with tilt (-6.373215 -0.4561576 -0.65341273)
  1 by 1 by 1 MPI processor grid
  restoring pair style lj/cut from restart
  restoring bond style harmonic from restart
  restoring angle style hybrid from restart
  restoring dihedral style harmonic from restart
  350 atoms
  375 bonds
  709 angles
  879 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.001 seconds
include ./input/angles_333U-50C-20-vasp.mod
angle_style hybrid fourier cosine/periodic
angle_coeff 1 fourier 58.020602        0.343737        0.374972        0.281246
angle_coeff 2 fourier 157.882480        0.343737        0.374972        0.281246
angle_coeff 3 fourier 83.380072        0.343737        0.374972        0.281246
angle_coeff 4 fourier 221.735285        0.343737        0.374972        0.281246
angle_coeff 5 fourier 114.246973        0.343737        0.374972        0.281246
angle_coeff 6 fourier 32.417871        0.343737        0.374972        0.281246
angle_coeff 7 fourier 90.420412        0.343737        0.374972        0.281246
angle_coeff 8 fourier 75.498766        0.343737        0.374972        0.281246
angle_coeff 9 cosine/periodic 88.853997              -1               3

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.02*${len0}
variable delta equal -0.02*17.311015182669
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.02*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.02*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.34622030365338 remap units box
Changing box ...
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.371963 14.630725 17.159756) with tilt (-6.373215 -0.8023779 -0.65341273)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 6 of 6 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 7 5 5
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
Per MPI rank memory allocation (min/avg/max) = 19.5 | 19.5 | 19.5 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
    250082   285.97298     -430.78108      676.57737      543.29476      5170.4444    
    250109   285.97298     -467.61029      380.0249       209.91307      541.32311    
Loop time of 0.0264398 on 1 procs for 27 steps with 350 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
      245.796298405817  -87.5853921759554  -87.5853921759554
  Force two-norm initial, final = 670.33938 27.519011
  Force max component initial, final = 95.263954 4.210193
  Final line search alpha, max atom move = 8.4560837e-12 3.5601744e-11
  Iterations, force evaluations = 27 112

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.020053   | 0.020053   | 0.020053   |   0.0 | 75.84
Bond    | 0.0053437  | 0.0053437  | 0.0053437  |   0.0 | 20.21
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00059054 | 0.00059054 | 0.00059054 |   0.0 |  2.23
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0004529  |            |       |  1.71

Nlocal:            350 ave         350 max         350 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2092 ave        2092 max        2092 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          20948 ave       20948 max       20948 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 20948
Ave neighs/atom = 59.851429
Ave special neighs/atom = 6.1942857
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -1610.4767109225
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 1830.51781210992
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 1403.92822935521
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 484.600245701324
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 6734.84927204962
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 1838.53649556413

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal -12.4419309706237
variable C2neg equal ${d2}
variable C2neg equal -14.951004867624
variable C3neg equal ${d3}
variable C3neg equal -45.1700490071729
variable C4neg equal ${d4}
variable C4neg equal -6.11892443814985
variable C5neg equal ${d5}
variable C5neg equal 28.573719796191
variable C6neg equal ${d6}
variable C6neg equal 6.82101661392659

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart_333U-50C-20-vasp.equil
Reading restart file ...
  restart file = 10 Sep 2025, LAMMPS = 10 Sep 2025
  restoring atom style full from restart
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.371963 14.630725 17.159756) with tilt (-6.373215 -0.4561576 -0.65341273)
  1 by 1 by 1 MPI processor grid
  restoring pair style lj/cut from restart
  restoring bond style harmonic from restart
  restoring angle style hybrid from restart
  restoring dihedral style harmonic from restart
  350 atoms
  375 bonds
  709 angles
  879 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.001 seconds
include ./input/angles_333U-50C-20-vasp.mod
angle_style hybrid fourier cosine/periodic
angle_coeff 1 fourier 58.020602        0.343737        0.374972        0.281246
angle_coeff 2 fourier 157.882480        0.343737        0.374972        0.281246
angle_coeff 3 fourier 83.380072        0.343737        0.374972        0.281246
angle_coeff 4 fourier 221.735285        0.343737        0.374972        0.281246
angle_coeff 5 fourier 114.246973        0.343737        0.374972        0.281246
angle_coeff 6 fourier 32.417871        0.343737        0.374972        0.281246
angle_coeff 7 fourier 90.420412        0.343737        0.374972        0.281246
angle_coeff 8 fourier 75.498766        0.343737        0.374972        0.281246
angle_coeff 9 cosine/periodic 88.853997              -1               3

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.02*${len0}
variable delta equal 0.02*17.311015182669
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.02*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.02*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.34622030365338 remap units box
Changing box ...
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.371963 14.630725 17.159756) with tilt (-6.373215 -0.10993729 -0.65341273)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 6 of 6 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 7 5 5
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
Per MPI rank memory allocation (min/avg/max) = 19.5 | 19.5 | 19.5 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
    250082   285.97298     -429.21805      672.56608      540.84649      5259.6097    
    250123   285.97298     -467.37792      370.75704      200.87758      611.88516    
Loop time of 0.0329908 on 1 procs for 41 steps with 350 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
      243.348031208343  -96.6208827499417  -96.6208827499417
  Force two-norm initial, final = 662.80431 17.312643
  Force max component initial, final = 78.897734 2.3926915
  Final line search alpha, max atom move = 3.5646293e-11 8.5290582e-11
  Iterations, force evaluations = 41 138

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.024985   | 0.024985   | 0.024985   |   0.0 | 75.73
Bond    | 0.0066834  | 0.0066834  | 0.0066834  |   0.0 | 20.26
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00074895 | 0.00074895 | 0.00074895 |   0.0 |  2.27
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0005733  |            |       |  1.74

Nlocal:            350 ave         350 max         350 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2092 ave        2092 max        2092 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          20955 ave       20955 max       20955 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 20955
Ave neighs/atom = 59.871429
Ave special neighs/atom = 6.1942857
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -96.6208827499417
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 611.885157441559
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -1514.95165851359
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 501.156924910012
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 2849.45020592825
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 1268.89118401802
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -2303.19752063837
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 368.385477401169

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 11.9643057085791
variable C2pos equal ${d2}
variable C2pos equal 21.5978093036235
variable C3pos equal ${d3}
variable C3pos equal 37.9424391243078
variable C4pos equal ${d4}
variable C4pos equal 13.4696795289647
variable C5pos equal ${d5}
variable C5pos equal 16.6165141672489
variable C6pos equal ${d6}
variable C6pos equal -10.7424713055101

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-12.4419309706237+${C1pos})
variable C15 equal 0.5*(-12.4419309706237+11.9643057085791)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-14.951004867624+${C2pos})
variable C25 equal 0.5*(-14.951004867624+21.5978093036235)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-45.1700490071729+${C3pos})
variable C35 equal 0.5*(-45.1700490071729+37.9424391243078)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-6.11892443814985+${C4pos})
variable C45 equal 0.5*(-6.11892443814985+13.4696795289647)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(28.573719796191+${C5pos})
variable C55 equal 0.5*(28.573719796191+16.6165141672489)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(6.82101661392659+${C6pos})
variable C65 equal 0.5*(6.82101661392659+-10.7424713055101)

# Delete dir to make sure it is not reused

variable dir delete

# uxy Perturbation

variable dir equal 6
include ./input/displace_333U-50C-20-vasp.mod
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 14.7586388725461

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart_333U-50C-20-vasp.equil
Reading restart file ...
  restart file = 10 Sep 2025, LAMMPS = 10 Sep 2025
  restoring atom style full from restart
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.371963 14.630725 17.159756) with tilt (-6.373215 -0.4561576 -0.65341273)
  1 by 1 by 1 MPI processor grid
  restoring pair style lj/cut from restart
  restoring bond style harmonic from restart
  restoring angle style hybrid from restart
  restoring dihedral style harmonic from restart
  350 atoms
  375 bonds
  709 angles
  879 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.001 seconds
include ./input/angles_333U-50C-20-vasp.mod
angle_style hybrid fourier cosine/periodic
angle_coeff 1 fourier 58.020602        0.343737        0.374972        0.281246
angle_coeff 2 fourier 157.882480        0.343737        0.374972        0.281246
angle_coeff 3 fourier 83.380072        0.343737        0.374972        0.281246
angle_coeff 4 fourier 221.735285        0.343737        0.374972        0.281246
angle_coeff 5 fourier 114.246973        0.343737        0.374972        0.281246
angle_coeff 6 fourier 32.417871        0.343737        0.374972        0.281246
angle_coeff 7 fourier 90.420412        0.343737        0.374972        0.281246
angle_coeff 8 fourier 75.498766        0.343737        0.374972        0.281246
angle_coeff 9 cosine/periodic 88.853997              -1               3

# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.02*${len0}
variable delta equal -0.02*14.7586388725461
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.02*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.02*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.295172777450922 remap units box
Changing box ...
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.371963 14.630725 17.159756) with tilt (-6.6683878 -0.4561576 -0.65341273)

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 6 of 6 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 7 5 5
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
Per MPI rank memory allocation (min/avg/max) = 19.5 | 19.5 | 19.5 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
    250082   285.97298     -429.78222      672.75459      540.47083      5157.9416    
    250119   285.97298     -468.18037      374.71558      204.03367     -5.9421776    
Loop time of 0.0321258 on 1 procs for 37 steps with 350 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
      242.972366766921  -93.4647884406946  -93.4647884406946
  Force two-norm initial, final = 658.26409 19.758636
  Force max component initial, final = 87.051763 2.5609458
  Final line search alpha, max atom move = 1.8636014e-11 4.7725823e-11
  Iterations, force evaluations = 37 132

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.024333   | 0.024333   | 0.024333   |   0.0 | 75.74
Bond    | 0.0064902  | 0.0064902  | 0.0064902  |   0.0 | 20.20
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00073122 | 0.00073122 | 0.00073122 |   0.0 |  2.28
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0005713  |            |       |  1.78

Nlocal:            350 ave         350 max         350 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2104 ave        2104 max        2104 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          20971 ave       20971 max       20971 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 20971
Ave neighs/atom = 59.917143
Ave special neighs/atom = 6.1942857
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -2458.24024677956
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 4.93595270983819
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 2435.47776128011
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 4003.49419068953
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 1912.25440903237
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 569.117331624722

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal -16.680748649909
variable C2neg equal ${d2}
variable C2neg equal -24.0789141646244
variable C3neg equal ${d3}
variable C3neg equal -40.0123013475485
variable C4neg equal ${d4}
variable C4neg equal -12.4660202578469
variable C5neg equal ${d5}
variable C5neg equal 4.4607454811048
variable C6neg equal ${d6}
variable C6neg equal 24.4154863388676

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart_333U-50C-20-vasp.equil
Reading restart file ...
  restart file = 10 Sep 2025, LAMMPS = 10 Sep 2025
  restoring atom style full from restart
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.371963 14.630725 17.159756) with tilt (-6.373215 -0.4561576 -0.65341273)
  1 by 1 by 1 MPI processor grid
  restoring pair style lj/cut from restart
  restoring bond style harmonic from restart
  restoring angle style hybrid from restart
  restoring dihedral style harmonic from restart
  350 atoms
  375 bonds
  709 angles
  879 dihedrals
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        1       
  special bond factors coul:  0        0        1       
     4 = max # of 1-2 neighbors
    10 = max # of 1-3 neighbors
    14 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.001 seconds
include ./input/angles_333U-50C-20-vasp.mod
angle_style hybrid fourier cosine/periodic
angle_coeff 1 fourier 58.020602        0.343737        0.374972        0.281246
angle_coeff 2 fourier 157.882480        0.343737        0.374972        0.281246
angle_coeff 3 fourier 83.380072        0.343737        0.374972        0.281246
angle_coeff 4 fourier 221.735285        0.343737        0.374972        0.281246
angle_coeff 5 fourier 114.246973        0.343737        0.374972        0.281246
angle_coeff 6 fourier 32.417871        0.343737        0.374972        0.281246
angle_coeff 7 fourier 90.420412        0.343737        0.374972        0.281246
angle_coeff 8 fourier 75.498766        0.343737        0.374972        0.281246
angle_coeff 9 cosine/periodic 88.853997              -1               3

# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.02*${len0}
variable delta equal 0.02*14.7586388725461
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.02*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.02*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.295172777450922 remap units box
Changing box ...
  triclinic box = (-0.1337571 -0.12791394 -0.15125959) to (15.371963 14.630725 17.159756) with tilt (-6.0780422 -0.4561576 -0.65341273)

# Relax atoms positions

minimize ${etol} ${ftol} ${maxiter} ${maxeval}
minimize 0 ${ftol} ${maxiter} ${maxeval}
minimize 0 1e-10 ${maxiter} ${maxeval}
minimize 0 1e-10 100000 ${maxeval}
minimize 0 1e-10 100000 100000
Generated 6 of 6 mixed pair_coeff terms from arithmetic mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7
  ghost atom cutoff = 7
  binsize = 3.5, bins = 7 5 5
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/tri
      bin: standard
WARNING: Inconsistent image flags
For more information see https://docs.lammps.org/err0027 (src/domain.cpp:1052)
Per MPI rank memory allocation (min/avg/max) = 19.5 | 19.5 | 19.5 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
    250082   285.97298     -430.06537      673.72036      541.15345      5281.8622    
    250132   285.97298     -469.54643      372.50684      200.45887     -190.5994     
Loop time of 0.0386385 on 1 procs for 50 steps with 350 atoms

100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
      243.654987375805  -97.0395899306671  -97.0395899306671
  Force two-norm initial, final = 672.39269 11.758049
  Force max component initial, final = 86.889724 1.9274118
  Final line search alpha, max atom move = 4.7286633e-11 9.1140815e-11
  Iterations, force evaluations = 50 156

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.02923    | 0.02923    | 0.02923    |   0.0 | 75.65
Bond    | 0.0078507  | 0.0078507  | 0.0078507  |   0.0 | 20.32
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00086222 | 0.00086222 | 0.00086222 |   0.0 |  2.23
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0006955  |            |       |  1.80

Nlocal:            350 ave         350 max         350 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           2068 ave        2068 max        2068 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          20930 ave       20930 max       20930 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 20930
Ave neighs/atom = 59.8
Ave special neighs/atom = 6.1942857
Neighbor list builds = 0
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -97.0395899306671
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -190.599401260833
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -1888.59919447375
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 378.5775821452
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 938.223408546047
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -1682.68593210811
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 1806.13870378945
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 914.743881762053

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 13.8325433883799
variable C2pos equal ${d2}
variable C2pos equal 22.2107060174476
variable C3pos equal ${d3}
variable C3pos equal 47.4985731112188
variable C4pos equal ${d4}
variable C4pos equal 10.7378875071602
variable C5pos equal ${d5}
variable C5pos equal -3.9301669548902
variable C6pos equal ${d6}
variable C6pos equal 4.01541427512057

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-16.680748649909+${C1pos})
variable C16 equal 0.5*(-16.680748649909+13.8325433883799)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-24.0789141646244+${C2pos})
variable C26 equal 0.5*(-24.0789141646244+22.2107060174476)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-40.0123013475485+${C3pos})
variable C36 equal 0.5*(-40.0123013475485+47.4985731112188)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-12.4660202578469+${C4pos})
variable C46 equal 0.5*(-12.4660202578469+10.7378875071602)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(4.4607454811048+${C5pos})
variable C56 equal 0.5*(4.4607454811048+-3.9301669548902)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(24.4154863388676+${C6pos})
variable C66 equal 0.5*(24.4154863388676+4.01541427512057)

# Delete dir to make sure it is not reused

variable dir delete

# Output final values

variable C11all equal ${C11}
variable C11all equal 66.0712809199547
variable C22all equal ${C22}
variable C22all equal 47.628925217381
variable C33all equal ${C33}
variable C33all equal 53.378625265572

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(19.9438361228048+${C21})
variable C12all equal 0.5*(19.9438361228048+22.2868814702934)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(23.9717408345369+${C31})
variable C13all equal 0.5*(23.9717408345369+24.8004603371837)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(21.55982916401+${C32})
variable C23all equal 0.5*(21.55982916401+20.4569153870326)

variable C44all equal ${C44}
variable C44all equal 17.3801578999401
variable C55all equal ${C55}
variable C55all equal 22.59511698172
variable C66all equal ${C66}
variable C66all equal 14.2154503069941

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(0.6495821723681+${C41})
variable C14all equal 0.5*(0.6495821723681+1.04322376294195)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-0.2388126310223+${C51})
variable C15all equal 0.5*(-0.2388126310223+-1.55685736669938)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-1.42410263076455+${C61})
variable C16all equal 0.5*(-1.42410263076455+-0.209587467222505)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-2.4388233779725+${C42})
variable C24all equal 0.5*(-2.4388233779725+-1.65083400858525)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(3.32340221799975+${C52})
variable C25all equal 0.5*(3.32340221799975+-1.2909836055459)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(-0.934104073588401+${C62})
variable C26all equal 0.5*(-0.934104073588401+-0.587873387933705)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(-0.776202866692202+${C43})
variable C34all equal 0.5*(-0.776202866692202+-1.20526238432562)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-3.61380494143255+${C53})
variable C35all equal 0.5*(-3.61380494143255+-6.79812750847091)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(3.74313588183515+${C63})
variable C36all equal 0.5*(3.74313588183515+5.51296930479575)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(3.67537754540743+${C54})
variable C45all equal 0.5*(3.67537754540743+0.0886889698115998)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-0.86406637534335+${C64})
variable C46all equal 0.5*(-0.86406637534335+-0.537333353173525)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(0.2652892631073+${C65})
variable C56all equal 0.5*(0.2652892631073+-1.96072734579176)

# Average moduli for cubic crystals

variable C11cubic equal (${C11all}+${C22all}+${C33all})/3.0
variable C11cubic equal (66.0712809199547+${C22all}+${C33all})/3.0
variable C11cubic equal (66.0712809199547+47.628925217381+${C33all})/3.0
variable C11cubic equal (66.0712809199547+47.628925217381+53.378625265572)/3.0
variable C12cubic equal (${C12all}+${C13all}+${C23all})/3.0
variable C12cubic equal (21.1153587965491+${C13all}+${C23all})/3.0
variable C12cubic equal (21.1153587965491+24.3861005858603+${C23all})/3.0
variable C12cubic equal (21.1153587965491+24.3861005858603+21.0083722755213)/3.0
variable C44cubic equal (${C44all}+${C55all}+${C66all})/3.0
variable C44cubic equal (17.3801578999401+${C55all}+${C66all})/3.0
variable C44cubic equal (17.3801578999401+22.59511698172+${C66all})/3.0
variable C44cubic equal (17.3801578999401+22.59511698172+14.2154503069941)/3.0

variable bulkmodulus equal (${C11cubic}+2*${C12cubic})/3.0
variable bulkmodulus equal (55.6929438009692+2*${C12cubic})/3.0
variable bulkmodulus equal (55.6929438009692+2*22.1699438859769)/3.0
variable shearmodulus1 equal ${C44cubic}
variable shearmodulus1 equal 18.0635750628847
variable shearmodulus2 equal (${C11cubic}-${C12cubic})/2.0
variable shearmodulus2 equal (55.6929438009692-${C12cubic})/2.0
variable shearmodulus2 equal (55.6929438009692-22.1699438859769)/2.0
variable poissonratio equal 1.0/(1.0+${C11cubic}/${C12cubic})
variable poissonratio equal 1.0/(1.0+55.6929438009692/${C12cubic})
variable poissonratio equal 1.0/(1.0+55.6929438009692/22.1699438859769)

print "Elastic Constant 1 1 = ${C11all}"
Elastic Constant 1 1 = 66.0712809199547
print "Elastic Constant 2 2 = ${C22all}"
Elastic Constant 2 2 = 47.628925217381
print "Elastic Constant 3 3 = ${C33all}"
Elastic Constant 3 3 = 53.378625265572

print "Elastic Constant 1 2 = ${C12all}"
Elastic Constant 1 2 = 21.1153587965491
print "Elastic Constant 1 3 = ${C13all}"
Elastic Constant 1 3 = 24.3861005858603
print "Elastic Constant 2 3 = ${C23all}"
Elastic Constant 2 3 = 21.0083722755213

print "Elastic Constant 4 4 = ${C44all}"
Elastic Constant 4 4 = 17.3801578999401
print "Elastic Constant 5 5 = ${C55all}"
Elastic Constant 5 5 = 22.59511698172
print "Elastic Constant 6 6 = ${C66all}"
Elastic Constant 6 6 = 14.2154503069941

print "Elastic Constant 1 4 = ${C14all}"
Elastic Constant 1 4 = 0.846402967655025
print "Elastic Constant 1 5 = ${C15all}"
Elastic Constant 1 5 = -0.89783499886084
print "Elastic Constant 1 6 = ${C16all}"
Elastic Constant 1 6 = -0.816845048993528

print "Elastic Constant 2 4 = ${C24all}"
Elastic Constant 2 4 = -2.04482869327888
print "Elastic Constant 2 5 = ${C25all}"
Elastic Constant 2 5 = 1.01620930622693
print "Elastic Constant 2 6 = ${C26all}"
Elastic Constant 2 6 = -0.760988730761053

print "Elastic Constant 3 4 = ${C34all}"
Elastic Constant 3 4 = -0.990732625508911
print "Elastic Constant 3 5 = ${C35all}"
Elastic Constant 3 5 = -5.20596622495173
print "Elastic Constant 3 6 = ${C36all}"
Elastic Constant 3 6 = 4.62805259331545

print "Elastic Constant 4 5 = ${C45all}"
Elastic Constant 4 5 = 1.88203325760951
print "Elastic Constant 4 6 = ${C46all}"
Elastic Constant 4 6 = -0.700699864258437
print "Elastic Constant 5 6 = ${C56all}"
Elastic Constant 5 6 = -0.84771904134223

print "Bulk Modulus = ${bulkmodulus} ${cunits}"
Bulk Modulus = 33.3442771909743 GPa
print "Shear Modulus 1 = ${shearmodulus1} ${cunits}"
Shear Modulus 1 = 18.0635750628847 GPa
print "Shear Modulus 2 = ${shearmodulus2} ${cunits}"
Shear Modulus 2 = 16.7614999574962 GPa
print "Poisson Ratio = ${poissonratio}"
Poisson Ratio = 0.284730563488897

variable rho equal density
print "density (g/cm^3) = ${rho}"
density (g/cm^3) = 1.63946007352635
Total wall time: 0:00:57
